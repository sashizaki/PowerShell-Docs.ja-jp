---
external help file: Microsoft.PowerShell.Commands.Diagnostics.dll-Help.xml
keywords: powershell,コマンドレット
Locale: en-US
Module Name: Microsoft.PowerShell.Diagnostics
ms.date: 11/20/2019
online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.diagnostics/get-winevent?view=powershell-6&WT.mc_id=ps-gethelp
schema: 2.0.0
title: Get-WinEvent
ms.openlocfilehash: 72455745d4523a33cac4ccca5af9c8be29ac9e37
ms.sourcegitcommit: 9b28fb9a3d72655bb63f62af18b3a5af6a05cd3f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/07/2020
ms.locfileid: "93217115"
---
# <span data-ttu-id="7a3ae-103">Get-WinEvent</span><span class="sxs-lookup"><span data-stu-id="7a3ae-103">Get-WinEvent</span></span>

## <span data-ttu-id="7a3ae-104">概要</span><span class="sxs-lookup"><span data-stu-id="7a3ae-104">SYNOPSIS</span></span>
<span data-ttu-id="7a3ae-105">ローカルおよびリモート コンピューター上のイベント ログとイベント トレース ログ ファイルからイベントを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-105">Gets events from event logs and event tracing log files on local and remote computers.</span></span>

## <span data-ttu-id="7a3ae-106">SYNTAX</span><span class="sxs-lookup"><span data-stu-id="7a3ae-106">SYNTAX</span></span>

### <span data-ttu-id="7a3ae-107">GetLogSet (既定値)</span><span class="sxs-lookup"><span data-stu-id="7a3ae-107">GetLogSet (Default)</span></span>

```
Get-WinEvent [[-LogName] <String[]>] [-MaxEvents <Int64>] [-ComputerName <String>]
 [-Credential <PSCredential>] [-FilterXPath <String>] [-Force] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="7a3ae-108">ListLogSet</span><span class="sxs-lookup"><span data-stu-id="7a3ae-108">ListLogSet</span></span>

```
Get-WinEvent [-ListLog] <String[]> [-ComputerName <String>] [-Credential <PSCredential>] [-Force]
 [<CommonParameters>]
```

### <span data-ttu-id="7a3ae-109">ListProviderSet</span><span class="sxs-lookup"><span data-stu-id="7a3ae-109">ListProviderSet</span></span>

```
Get-WinEvent [-ListProvider] <String[]> [-ComputerName <String>] [-Credential <PSCredential>]
 [<CommonParameters>]
```

### <span data-ttu-id="7a3ae-110">GetProviderSet</span><span class="sxs-lookup"><span data-stu-id="7a3ae-110">GetProviderSet</span></span>

```
Get-WinEvent [-ProviderName] <String[]> [-MaxEvents <Int64>] [-ComputerName <String>]
 [-Credential <PSCredential>] [-FilterXPath <String>] [-Force] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="7a3ae-111">個</span><span class="sxs-lookup"><span data-stu-id="7a3ae-111">FileSet</span></span>

```
Get-WinEvent [-Path] <String[]> [-MaxEvents <Int64>] [-Credential <PSCredential>]
 [-FilterXPath <String>] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="7a3ae-112">HashQuerySet</span><span class="sxs-lookup"><span data-stu-id="7a3ae-112">HashQuerySet</span></span>

```
Get-WinEvent [-MaxEvents <Int64>] [-ComputerName <String>] [-Credential <PSCredential>]
 [-FilterHashtable] <Hashtable[]> [-Force] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="7a3ae-113">XmlQuerySet</span><span class="sxs-lookup"><span data-stu-id="7a3ae-113">XmlQuerySet</span></span>

```
Get-WinEvent [-MaxEvents <Int64>] [-ComputerName <String>] [-Credential <PSCredential>]
 [-FilterXml] <XmlDocument> [-Oldest] [<CommonParameters>]
```

## <span data-ttu-id="7a3ae-114">Description</span><span class="sxs-lookup"><span data-stu-id="7a3ae-114">DESCRIPTION</span></span>

<span data-ttu-id="7a3ae-115">コマンドレットでは、 `Get-WinEvent` **システム** ログや **アプリケーション** ログなどの従来のログを含むイベントログからイベントを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-115">The `Get-WinEvent` cmdlet gets events from event logs, including classic logs, such as the **System** and **Application** logs.</span></span> <span data-ttu-id="7a3ae-116">コマンドレットは、Windows Vista で導入された Windows イベントログのテクノロジによって生成されるイベントログからデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-116">The cmdlet gets data from event logs that are generated by the Windows Event Log technology introduced in Windows Vista.</span></span> <span data-ttu-id="7a3ae-117">また、 **Windows イベントトレーシング (ETW)** によって生成されるログファイル内のイベントです。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-117">And, events in log files generated by **Event Tracing for Windows (ETW)**.</span></span> <span data-ttu-id="7a3ae-118">既定では、は、 `Get-WinEvent` 最新から古い順にイベント情報を返します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-118">By default, `Get-WinEvent` returns event information in the order of newest to oldest.</span></span>

<span data-ttu-id="7a3ae-119">`Get-WinEvent` イベントログとイベントログプロバイダーの一覧を表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-119">`Get-WinEvent` lists event logs and event log providers.</span></span> <span data-ttu-id="7a3ae-120">コマンドを中断するには、 <kbd>ctrl</kbd> + <kbd>C</kbd>キーを押します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-120">To interrupt the command, press <kbd>CTRL</kbd>+<kbd>C</kbd>.</span></span> <span data-ttu-id="7a3ae-121">選択したログまたは選択したイベント プロバイダーによって生成されたログからイベントを取得できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-121">You can get events from selected logs or from logs generated by selected event providers.</span></span> <span data-ttu-id="7a3ae-122">さらに、1 つのコマンドで複数のソースからのイベントを組み合わせることができます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-122">And, you can combine events from multiple sources in a single command.</span></span>
<span data-ttu-id="7a3ae-123">`Get-WinEvent` では、XPath クエリ、構造化 XML クエリ、およびハッシュテーブルクエリを使用してイベントをフィルター処理できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-123">`Get-WinEvent` allows you to filter events using XPath queries, structured XML queries, and hash table queries.</span></span>

<span data-ttu-id="7a3ae-124">PowerShell を管理者として実行していない場合は、ログに関する情報を取得できないというエラーメッセージが表示されることがあります。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-124">If you're not running PowerShell as an Administrator, you might see error messages that you cannot retrieve information about a log.</span></span>

## <span data-ttu-id="7a3ae-125">例</span><span class="sxs-lookup"><span data-stu-id="7a3ae-125">EXAMPLES</span></span>

### <span data-ttu-id="7a3ae-126">例 1: ローカルコンピューターからすべてのログを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-126">Example 1: Get all the logs from a local computer</span></span>

<span data-ttu-id="7a3ae-127">このコマンドは、ローカルコンピューター上のすべてのイベントログを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-127">This command gets all the event logs on the local computer.</span></span> <span data-ttu-id="7a3ae-128">ログは、取得した順に一覧表示され `Get-WinEvent` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-128">Logs are listed in the order that `Get-WinEvent` gets them.</span></span> <span data-ttu-id="7a3ae-129">まず、従来のログを取得し、次に新しい Windows イベントログを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-129">Classic logs are retrieved first, followed by the new Windows Event logs.</span></span>
<span data-ttu-id="7a3ae-130">ログの **RecordCount** を null (空白またはゼロ) にすることができます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-130">It's possible for a log's **RecordCount** to be null, which is blank, or zero.</span></span>

```powershell
Get-WinEvent -ListLog *
```

```Output
LogMode   MaximumSizeInBytes RecordCount LogName
-------   ------------------ ----------- -------
Circular            15532032       14500 Application
Circular             1052672         117 Azure Information Protection
Circular             1052672        3015 CxAudioSvcLog
Circular            20971520             ForwardedEvents
Circular            20971520           0 HardwareEvents
```

<span data-ttu-id="7a3ae-131">`Get-WinEvent`コマンドレットは、コンピューターからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-131">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="7a3ae-132">**Listlog** パラメーターでは、アスタリスク ( `*` ) のワイルドカードを使用して、各ログに関する情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-132">The **ListLog** parameter uses the asterisk (`*`) wildcard to display information about each log.</span></span>

### <span data-ttu-id="7a3ae-133">例 2: クラシックセットアップログを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-133">Example 2: Get the classic Setup log</span></span>

<span data-ttu-id="7a3ae-134">このコマンドは、クラシック **セットアップ** ログを表す **EventLogConfiguration** オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-134">This command gets an **EventLogConfiguration** object that represents the classic **Setup** log.</span></span> <span data-ttu-id="7a3ae-135">オブジェクトには、ファイルサイズ、プロバイダー、ファイルパス、ログが有効かどうかなど、ログに関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-135">The object includes information about the log, such as file size, provider, file path, and whether the log is enabled.</span></span>

```powershell
Get-WinEvent -ListLog Setup | Format-List -Property *
```

```Output
FileSize                       : 69632
IsLogFull                      : False
LastAccessTime                 : 3/13/2019 09:41:46
LastWriteTime                  : 3/13/2019 09:41:46
OldestRecordNumber             : 1
RecordCount                    : 23
LogName                        : Setup
LogType                        : Operational
LogIsolation                   : Application
IsEnabled                      : True
IsClassicLog                   : False
SecurityDescriptor             : O:BAG:SYD: ...
LogFilePath                    : %SystemRoot%\System32\Winevt\Logs\Setup.evtx
MaximumSizeInBytes             : 1052672
LogMode                        : Circular
OwningProviderName             : Microsoft-Windows-Eventlog
ProviderNames                  : {Microsoft-Windows-WUSA, Microsoft-Windows-ActionQueue...
ProviderLevel                  :
ProviderKeywords               :
ProviderBufferSize             : 64
ProviderMinimumNumberOfBuffers : 0
ProviderMaximumNumberOfBuffers : 64
ProviderLatency                : 1000
ProviderControlGuid            :
```

<span data-ttu-id="7a3ae-136">コマンドレットでは、 `Get-WinEvent` **listlog** パラメーターを使用して **セットアップ** ログを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-136">The `Get-WinEvent` cmdlet uses the **ListLog** parameter to specify the **Setup** log.</span></span> <span data-ttu-id="7a3ae-137">オブジェクトは、パイプラインを介してコマンドレットに送信され `Format-List` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-137">The object is sent down the pipeline to the `Format-List` cmdlet.</span></span> <span data-ttu-id="7a3ae-138">`Format-List`**プロパティ** パラメーターをアスタリスク () ワイルドカードと共に使用して、 `*` 各プロパティを表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-138">`Format-List` uses the **Property** parameter with the asterisk (`*`) wildcard to display each property.</span></span>

### <span data-ttu-id="7a3ae-139">例 3: サーバーからイベントログを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-139">Example 3: Get event logs from a server</span></span>

<span data-ttu-id="7a3ae-140">このコマンドは、イベントを含むローカルコンピューター上のイベントログのみを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-140">This command only gets event logs on the local computer that contain events.</span></span> <span data-ttu-id="7a3ae-141">ログの **RecordCount** を null または0にすることができます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-141">It's possible for a log's **RecordCount** to be null or zero.</span></span> <span data-ttu-id="7a3ae-142">この例では、変数を使用し `$_` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-142">The example uses the `$_` variable.</span></span> <span data-ttu-id="7a3ae-143">詳細については、「 [about_Automatic_Variables](../Microsoft.PowerShell.Core/about/about_automatic_variables.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-143">For more information, see [about_Automatic_Variables](../Microsoft.PowerShell.Core/about/about_automatic_variables.md).</span></span>

```powershell
Get-WinEvent -ListLog * -ComputerName localhost | Where-Object { $_.RecordCount }
```

```Output
LogMode   MaximumSizeInBytes RecordCount LogName
-------   ------------------ ----------- -------
Circular            15532032       14546 Application
Circular             1052672         117 Azure Information Protection
Circular             1052672        2990 CxAudioSvcLog
Circular             1052672           9 MSFTVPN Setup
Circular             1052672         282 OAlerts
```

<span data-ttu-id="7a3ae-144">`Get-WinEvent`コマンドレットは、コンピューターからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-144">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="7a3ae-145">**Listlog** パラメーターでは、アスタリスク ( `*` ) のワイルドカードを使用して、各ログに関する情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-145">The **ListLog** parameter uses the asterisk (`*`) wildcard to display information about each log.</span></span> <span data-ttu-id="7a3ae-146">**ComputerName** パラメーターは、ローカルコンピューター ( **localhost** ) からログを取得するように指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-146">The **ComputerName** parameter specifies to get the logs from the local computer, **localhost**.</span></span> <span data-ttu-id="7a3ae-147">オブジェクトは、パイプラインを介してコマンドレットに送信され `Where-Object` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-147">The objects are sent down the pipeline to the `Where-Object` cmdlet.</span></span> <span data-ttu-id="7a3ae-148">`Where-Object` は `$_.RecordCount` 、データを含むログのみを返すためにを使用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-148">`Where-Object` uses `$_.RecordCount` to return only logs that contain data.</span></span> <span data-ttu-id="7a3ae-149">`$_` は、パイプライン内の現在のオブジェクトを表す変数です。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-149">`$_` is a variable that represents the current object in the pipeline.</span></span> <span data-ttu-id="7a3ae-150">**RecordCount** は、null 以外の値を持つオブジェクトのプロパティです。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-150">**RecordCount** is a property of the object with a non-null value.</span></span>

### <span data-ttu-id="7a3ae-151">例 4: 複数のサーバーからイベントログを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-151">Example 4: Get event logs from multiple servers</span></span>

<span data-ttu-id="7a3ae-152">この例では、Server01、Server02、および Server03 の3台のコンピューター上の **アプリケーション** イベントログを表すオブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-152">This example gets objects that represent the **Application** event logs on three computers: Server01, Server02, and Server03.</span></span> <span data-ttu-id="7a3ae-153">**ComputerName** パラメーターは値を1つだけ受け入れるため、 **ForEach** キーワードが使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-153">The **ForEach** keyword is used because the **ComputerName** parameter accepts only one value.</span></span> <span data-ttu-id="7a3ae-154">詳細については、「 [about_Foreach](../Microsoft.PowerShell.Core/about/about_Foreach.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-154">For more information, see [about_Foreach](../Microsoft.PowerShell.Core/about/about_Foreach.md).</span></span>

```powershell
$S = 'Server01', 'Server02', 'Server03'
ForEach ($Server in $S) {
  Get-WinEvent -ListLog Application -ComputerName $Server |
    Select-Object LogMode, MaximumSizeInBytes, RecordCount, LogName,
      @{name='ComputerName'; expression={$Server}} |
    Format-Table -AutoSize
}
```

```Output
 LogMode MaximumSizeInBytes RecordCount LogName     ComputerName
 ------- ------------------ ----------- -------     ------------
Circular           15532032       14577 Application Server01
Circular           15532032        9689 Application Server02
Circular           15532032        5309 Application Server03
```

<span data-ttu-id="7a3ae-155">変数には、 `$S` 3 つのサーバー ( **Server01** 、 **Server02** 、 **Server03** ) という名前が格納されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-155">The variable `$S` stores the names three servers: **Server01** , **Server02** , and **Server03**.</span></span> <span data-ttu-id="7a3ae-156">**ForEach** ステートメントでは、ループを使用して各サーバーを処理し `($Server in $S)` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-156">The **ForEach** statement uses a loop to process each server, `($Server in $S)`.</span></span> <span data-ttu-id="7a3ae-157">中かっこ () 内のスクリプトブロックは、 `{ }` コマンドを実行し `Get-WinEvent` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-157">The script block in the curly braces (`{ }`) runs the `Get-WinEvent` command.</span></span> <span data-ttu-id="7a3ae-158">**Listlog** パラメーターは、 **アプリケーション** ログを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-158">The **ListLog** parameter specifies the **Application** log.</span></span> <span data-ttu-id="7a3ae-159">**ComputerName** パラメーターは、変数を使用して `$Server` 各サーバーからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-159">The **ComputerName** parameter uses the variable `$Server` to get log information from each server.</span></span>

<span data-ttu-id="7a3ae-160">オブジェクトは、パイプラインを介してコマンドレットに送信され `Select-Object` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-160">The objects are sent down the pipeline to the `Select-Object` cmdlet.</span></span> <span data-ttu-id="7a3ae-161">`Select-Object`**Logmode** 、 **maximumsizeinbytes** 、 **RecordCount** 、 **LogName** の各プロパティを取得し、計算された式を使用して、その変数を使用して **ComputerName** を表示し `$Server` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-161">`Select-Object` gets the properties **LogMode** , **MaximumSizeInBytes** , **RecordCount** , **LogName** , and uses a calculated expression to display the **ComputerName** using the `$Server` variable.</span></span> <span data-ttu-id="7a3ae-162">オブジェクトは、パイプラインを介してコマンドレットに送信され、 `Format-Table` PowerShell コンソールに出力を表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-162">The objects are sent down the pipeline to the `Format-Table` cmdlet to display the output in the PowerShell console.</span></span> <span data-ttu-id="7a3ae-163">**AutoSize** パラメーターは、画面に合うように出力を書式設定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-163">The **AutoSize** parameter formats the output to fit the screen.</span></span>

### <span data-ttu-id="7a3ae-164">例 5: イベントログプロバイダーとログ名を取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-164">Example 5: Get event log providers and log names</span></span>

<span data-ttu-id="7a3ae-165">このコマンドは、イベントログプロバイダーと、ログの書き込み先のログを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-165">This command gets the event log providers and the logs to which they write.</span></span>

```powershell
Get-WinEvent -ListProvider *
```

```Output
Name     : .NET Runtime
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}

Name     : .NET Runtime Optimization Service
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}
```

<span data-ttu-id="7a3ae-166">`Get-WinEvent`コマンドレットは、コンピューターからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-166">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="7a3ae-167">**ListProvider** パラメーターでは、アスタリスク ( `*` ) のワイルドカードを使用して、各プロバイダーに関する情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-167">The **ListProvider** parameter uses the asterisk (`*`) wildcard to display information about each provider.</span></span> <span data-ttu-id="7a3ae-168">出力では、 **名前** はプロバイダー、 **loglinks** はプロバイダーが書き込むログです。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-168">In the output, the **Name** is the provider and **LogLinks** is the log that the provider writes to.</span></span>

### <span data-ttu-id="7a3ae-169">例 6: 特定のログに書き込むすべてのイベントログプロバイダーを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-169">Example 6: Get all event log providers that write to a specific log</span></span>

<span data-ttu-id="7a3ae-170">このコマンドは、 **アプリケーション** ログに書き込むすべてのプロバイダーを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-170">This command gets all of the providers that write to the **Application** log.</span></span>

```powershell
(Get-WinEvent -ListLog Application).ProviderNames
```

```Output
.NET Runtime
.NET Runtime Optimization Service
Application
Application Error
Application Hang
Application Management
```

<span data-ttu-id="7a3ae-171">`Get-WinEvent`コマンドレットは、コンピューターからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-171">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="7a3ae-172">**Listlog** パラメーターは、 **アプリケーション** を使用して、そのログのオブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-172">The **ListLog** parameter uses **Application** to get objects for that log.</span></span> <span data-ttu-id="7a3ae-173">**Providernames** はオブジェクトのプロパティであり、 **アプリケーション** ログに書き込むプロバイダーを表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-173">**ProviderNames** is a property of the object and displays the providers that write to the **Application** log.</span></span>

### <span data-ttu-id="7a3ae-174">例 7: 特定の文字列を含むイベントログプロバイダーの名前を取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-174">Example 7: Get event log provider names that contain a specific string</span></span>

<span data-ttu-id="7a3ae-175">このコマンドは、プロバイダー名に特定の文字列を含む名前のイベントログプロバイダーを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-175">This command gets the event log providers with names that include a specific string in the provider's name.</span></span>

```powershell
Get-WinEvent -ListProvider *Policy*
```

```Output
Name     : Group Policy Applications
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}

Name     : Group Policy Client
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}

Name     : Group Policy Data Sources
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}
```

<span data-ttu-id="7a3ae-176">`Get-WinEvent`コマンドレットは、コンピューターからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-176">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="7a3ae-177">**ListProvider** パラメーターは、アスタリスク () のワイルドカードを使用して、 `*` プロバイダーの名前内の任意の場所で **ポリシー** を検索します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-177">The **ListProvider** parameter uses the asterisk (`*`) wildcard to find **Policy** anywhere within the provider's name.</span></span>

### <span data-ttu-id="7a3ae-178">例 8: イベントプロバイダーによって生成されるイベント Id を取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-178">Example 8: Get Event Ids that the event provider generates</span></span>

<span data-ttu-id="7a3ae-179">このコマンドは、イベントの説明と共に、 **Microsoft-Windows-GroupPolicy** イベントプロバイダーによって生成されるイベント id を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-179">This command lists the Event Ids that the **Microsoft-Windows-GroupPolicy** event provider generates along with the event description.</span></span>

```powershell
(Get-WinEvent -ListProvider Microsoft-Windows-GroupPolicy).Events | Format-Table Id, Description
```

```Output
  Id  Description
  --  -----------
1500  The Group Policy settings for the computer were processed successfully...
1501  The Group Policy settings for the user were processed successfully...
4115  Group Policy Service started.
4116  Started the Group Policy service initialization phase.
4117  Group Policy Session started.
```

<span data-ttu-id="7a3ae-180">`Get-WinEvent`コマンドレットは、コンピューターからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-180">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="7a3ae-181">**ListProvider** パラメーターは、プロバイダー、 **Microsoft-Windows-grouppolicy** を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-181">The **ListProvider** parameter specifies the provider, **Microsoft-Windows-GroupPolicy**.</span></span> <span data-ttu-id="7a3ae-182">式がかっこで囲まれ、 **Events** プロパティを使用してオブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-182">The expression is wrapped in parentheses and uses the **Events** property to get objects.</span></span> <span data-ttu-id="7a3ae-183">オブジェクトは、パイプラインを介してコマンドレットに送信され `Format-Table` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-183">The objects are sent down the pipeline to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="7a3ae-184">`Format-Table` イベントオブジェクトの **Id** と **説明** を表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-184">`Format-Table` displays the **Id** and **Description** of the event objects.</span></span>

### <span data-ttu-id="7a3ae-185">例 9: イベントオブジェクトのプロパティからログ情報を取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-185">Example 9: Get log information from event object properties</span></span>

<span data-ttu-id="7a3ae-186">この例では、イベントオブジェクトのプロパティを使用して、ログの内容に関する情報を取得する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-186">This example shows how to get information about a log's contents using event object properties.</span></span>
<span data-ttu-id="7a3ae-187">イベントオブジェクトは変数に格納され、 **イベント Id** と **レベル** によってグループ化およびカウントされます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-187">Event objects are stored in a variable and then grouped and counted by **Event Id** and **Level**.</span></span>

```powershell
$Event = Get-WinEvent -LogName 'Windows PowerShell'
$Event.Count
$Event | Group-Object -Property Id -NoElement | Sort-Object -Property Count -Descending
$Event | Group-Object -Property LevelDisplayName -NoElement
```

```Output
195

Count  Name
-----  ----
  147  600
   22  400
   21  601
    3  403
    2  103

Count  Name
-----  ----
    2  Warning
  193  Information
```

<span data-ttu-id="7a3ae-188">`Get-WinEvent`コマンドレットでは、 **LogName** パラメーターを使用して **Windows PowerShell** イベントログを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-188">The `Get-WinEvent` cmdlet uses the **LogName** parameter to specify the **Windows PowerShell** event log.</span></span> <span data-ttu-id="7a3ae-189">イベントオブジェクトは変数に格納され `$Event` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-189">The event objects are stored in the `$Event` variable.</span></span> <span data-ttu-id="7a3ae-190">の **Count** プロパティは、 `$Event` ログに記録されたイベントの合計数を示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-190">The **Count** property of `$Event`shows the total number of logged events.</span></span>

<span data-ttu-id="7a3ae-191">変数は、パイプラインを介して `$Event` コマンドレットに送信され `Group-Object` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-191">The `$Event` variable is sent down the pipeline to the `Group-Object` cmdlet.</span></span> <span data-ttu-id="7a3ae-192">`Group-Object`**property** パラメーターを使用して **id** プロパティを指定し、イベント id 値によってオブジェクトをカウントします。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-192">`Group-Object` uses the **Property** parameter to specify the **Id** property and counts the objects by the event Id value.</span></span> <span data-ttu-id="7a3ae-193">**Noelement** パラメーターは、オブジェクトの出力から他のプロパティを削除します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-193">The **NoElement** parameter removes other properties from the objects output.</span></span> <span data-ttu-id="7a3ae-194">グループ化されたオブジェクトは、パイプラインを介してコマンドレットに送信され `Sort-Object` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-194">The grouped objects are sent down the pipeline to the `Sort-Object` cmdlet.</span></span> <span data-ttu-id="7a3ae-195">`Sort-Object`**Property** パラメーターを使用して、オブジェクトを **カウント** で並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-195">`Sort-Object` uses the **Property** parameter to sort the objects by **Count**.</span></span> <span data-ttu-id="7a3ae-196">[ **降順** ] パラメーターを指定すると、出力は、最大値から最低値までの数で表示されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-196">The **Descending** parameter displays the output by count, from highest to lowest.</span></span> <span data-ttu-id="7a3ae-197">出力の [ **カウント** ] 列には、各イベントの合計数が表示されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-197">In the output, the **Count** column contains the total number of each event.</span></span> <span data-ttu-id="7a3ae-198">**名前** 列には、グループ化されたイベント Id 番号が含まれます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-198">The **Name** column contains the grouped event Id numbers.</span></span>

<span data-ttu-id="7a3ae-199">変数は、パイプラインを介して `$Event` コマンドレットに送信され `Group-Object` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-199">The `$Event` variable is sent down the pipeline to the `Group-Object` cmdlet.</span></span> <span data-ttu-id="7a3ae-200">`Group-Object`**property** パラメーターを使用して **leveldisplayname** プロパティを指定し、 **leveldisplayname** でオブジェクトをカウントします。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-200">`Group-Object` uses the **Property** parameter to specify the **LevelDisplayName** property and counts the objects by **LevelDisplayName**.</span></span> <span data-ttu-id="7a3ae-201">オブジェクトは、 **警告** や **情報** などのレベルによってグループ化されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-201">The objects are grouped by the levels such as **Warning** and **Information**.</span></span>
<span data-ttu-id="7a3ae-202">**Noelement** パラメーターは、他のプロパティを出力から削除します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-202">The **NoElement** parameter removes other properties from the output.</span></span> <span data-ttu-id="7a3ae-203">出力の [ **カウント** ] 列には、各イベントの合計数が表示されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-203">In the output, the **Count** column contains the total number of each event.</span></span> <span data-ttu-id="7a3ae-204">**名前** 列には、グループ化された **leveldisplayname** が含まれます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-204">The **Name** column contains the grouped **LevelDisplayName**.</span></span>

### <span data-ttu-id="7a3ae-205">例 10: 名前に文字列が指定されているエラーイベントを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-205">Example 10: Get error events that have a specified string in their name</span></span>

<span data-ttu-id="7a3ae-206">この例では、ログ名のコンマ区切りの文字列を使用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-206">This example uses a comma-separated string of log names.</span></span> <span data-ttu-id="7a3ae-207">出力は、エラー、警告、ログ名などのレベルによってグループ化されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-207">The output is grouped by the level such as error or warning and the log name.</span></span>

```powershell
Get-WinEvent -LogName *PowerShell*, Microsoft-Windows-Kernel-WHEA* |
  Group-Object -Property LevelDisplayName, LogName -NoElement |
    Format-Table -AutoSize
```

```Output
Count  Name
-----  ----
    1  Error, PowerShellCore/Operational
   26  Information, Microsoft-Windows-Kernel-WHEA/Operational
  488  Information, Microsoft-Windows-PowerShell/Operational
   77  Information, PowerShellCore/Operational
 9835  Information, Windows PowerShell
   19  Verbose, PowerShellCore/Operational
  444  Warning, Microsoft-Windows-PowerShell/Operational
  512  Warning, PowerShellCore/Operational
```

<span data-ttu-id="7a3ae-208">`Get-WinEvent`コマンドレットは、コンピューターからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-208">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="7a3ae-209">**LogName** パラメーターでは、アスタリスク () のワイルドカードを含むコンマ区切りの文字列を使用して `*` 、ログ名を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-209">The **LogName** parameter uses a comma-separated string with the asterisk (`*`) wildcard to specify the log names.</span></span> <span data-ttu-id="7a3ae-210">オブジェクトは、パイプラインを介してコマンドレットに送信され `Group-Object` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-210">The objects are sent down the pipeline to the `Group-Object` cmdlet.</span></span> <span data-ttu-id="7a3ae-211">`Group-Object`**プロパティ** パラメーターを使用して、 **Leveldisplayname** と **LogName** でオブジェクトをグループ化します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-211">`Group-Object` uses the **Property** parameter to group the objects by **LevelDisplayName** and **LogName**.</span></span> <span data-ttu-id="7a3ae-212">**Noelement** パラメーターは、他のプロパティを出力から削除します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-212">The **NoElement** parameter removes other properties from the output.</span></span> <span data-ttu-id="7a3ae-213">グループ化されたオブジェクトは、パイプラインを介してコマンドレットに送信され `Format-Table` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-213">The grouped objects are sent down the pipeline to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="7a3ae-214">`Format-Table`**AutoSize** パラメーターを使用して、列の書式を設定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-214">`Format-Table` uses the **AutoSize** parameter to format the columns.</span></span> <span data-ttu-id="7a3ae-215">[ **カウント** 列には、各イベントの合計数が含まれます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-215">The **Count** column contains the total number of each event.</span></span> <span data-ttu-id="7a3ae-216">**名前** 列には、グループ化された **Leveldisplayname** と **LogName** が含まれます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-216">The **Name** column contains the grouped **LevelDisplayName** and **LogName**.</span></span>

### <span data-ttu-id="7a3ae-217">例 11: アーカイブされたイベントログからイベントを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-217">Example 11: Get events from an archived event log</span></span>

<span data-ttu-id="7a3ae-218">`Get-WinEvent` 保存されているログファイルからイベント情報を取得できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-218">`Get-WinEvent` can get event information from saved log files.</span></span> <span data-ttu-id="7a3ae-219">このサンプルでは、ローカルコンピューターに格納されているアーカイブ済みの PowerShell ログを使用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-219">This sample uses an archived PowerShell log that is stored on the local computer.</span></span>

```powershell
Get-WinEvent -Path 'C:\Test\Windows PowerShell.evtx'
```

```Output
   ProviderName: PowerShell

TimeCreated              Id LevelDisplayName  Message
-----------              -- ----------------  -------
3/15/2019 13:54:13      403 Information       Engine state is changed from Available to Stopped...
3/15/2019 13:54:13      400 Information       Engine state is changed from None to Available...
3/15/2019 13:54:13      600 Information       Provider "Variable" is Started...
3/15/2019 13:54:13      600 Information       Provider "Function" is Started...
3/15/2019 13:54:13      600 Information       Provider "FileSystem" is Started...
```

<span data-ttu-id="7a3ae-220">`Get-WinEvent`コマンドレットは、コンピューターからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-220">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="7a3ae-221">**Path** パラメーターには、ディレクトリとファイル名を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-221">The **Path** parameter specifies the directory and file name.</span></span>

### <span data-ttu-id="7a3ae-222">例 12: アーカイブされたイベントログから特定の数のイベントを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-222">Example 12: Get a specific number of events from an archived event log</span></span>

<span data-ttu-id="7a3ae-223">これらのコマンドは、アーカイブされたイベントログから特定の数のイベントを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-223">These commands get a specific number of events from an archived event log.</span></span> <span data-ttu-id="7a3ae-224">`Get-WinEvent` には、最大数のイベントまたは最も古いイベントを取得できるパラメーターがあります。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-224">`Get-WinEvent` has parameters that can get a maximum number of events or the oldest events.</span></span> <span data-ttu-id="7a3ae-225">このサンプルでは、 **C:\Test\PowerShellCore .evtx** に格納されているアーカイブ済みの PowerShell ログを使用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-225">This sample uses an archived PowerShell log that is stored in **C:\Test\PowerShellCore Operational.evtx**.</span></span>

```powershell
Get-WinEvent -Path 'C:\Test\PowerShellCore Operational.evtx' -MaxEvents 100
```

```Output
   ProviderName: PowerShellCore

TimeCreated                 Id   LevelDisplayName  Message
-----------                 --   ----------------  -------
3/15/2019 09:54:54        4104   Warning           Creating Scriptblock text (1 of 1):...
3/15/2019 09:37:13       40962   Information       PowerShell console is ready for user input
3/15/2019 07:56:24        4104   Warning           Creating Scriptblock text (1 of 1):...
...
3/7/2019 10:53:22        40961   Information       PowerShell console is starting up
3/7/2019 10:53:22         8197   Verbose           Runspace state changed to Opening
3/7/2019 10:53:22         8195   Verbose           Opening RunspacePool
```

<span data-ttu-id="7a3ae-226">`Get-WinEvent`コマンドレットは、コンピューターからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-226">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="7a3ae-227">**Path** パラメーターには、ディレクトリとファイル名を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-227">The **Path** parameter specifies the directory and filename.</span></span> <span data-ttu-id="7a3ae-228">**Maxevents** パラメーターを指定すると、100レコードが最新から古いものに表示されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-228">The **MaxEvents** parameter specifies that 100 records are displayed, from newest to oldest.</span></span>

### <span data-ttu-id="7a3ae-229">例 13: Windows イベントトレーシング</span><span class="sxs-lookup"><span data-stu-id="7a3ae-229">Example 13: Event Tracing for Windows</span></span>

<span data-ttu-id="7a3ae-230">Windows イベントトレーシング (ETW) は、イベントが発生したときにイベントをログに書き込みます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-230">Event Tracing for Windows (ETW) writes events to the log as events occur.</span></span> <span data-ttu-id="7a3ae-231">イベントは、最も古い順に格納されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-231">The events are stored in the order of oldest to newest.</span></span> <span data-ttu-id="7a3ae-232">アーカイブされた ETW ファイルは、 `.etl` **tracelog .etl** などとして保存されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-232">An archived ETW file is saved as an `.etl` such as **TraceLog.etl**.</span></span>
<span data-ttu-id="7a3ae-233">イベントはログに書き込まれた順序で一覧表示されるため、 *最も古い* パラメーターが必要です。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-233">The events are listed in the order in which they are written to the log, so the *Oldest* parameter is required.</span></span>

```powershell
Get-WinEvent -Path 'C:\Tracing\TraceLog.etl' -Oldest |
  Sort-Object -Property TimeCreated -Descending |
    Select-Object -First 100
```

<span data-ttu-id="7a3ae-234">コマンドレットは、アーカイブされ `Get-WinEvent` たファイルからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-234">The `Get-WinEvent` cmdlet gets log information from the archived file.</span></span> <span data-ttu-id="7a3ae-235">**Path** パラメーターには、ディレクトリとファイル名を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-235">The **Path** parameter specifies the directory and file name.</span></span> <span data-ttu-id="7a3ae-236">**最も古い** パラメーターは、イベントが書き込まれた順序でイベントを出力するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-236">The **Oldest** parameter is used to output events in the order they are written, oldest to newest.</span></span> <span data-ttu-id="7a3ae-237">オブジェクトはパイプラインの下に送信され `Sort-Object` 、 `Sort-Object` **TimeCreated** プロパティの値によって降順に並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-237">The objects are sent down the pipeline to the `Sort-Object` cmdlet `Sort-Object` sorts the objects in descending order by the value of the **TimeCreated** property.</span></span> <span data-ttu-id="7a3ae-238">オブジェクトは、 `Select-Object` 100 の最新のイベントを表示するコマンドレットにパイプラインを介して送信されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-238">The objects are sent down the pipeline to the `Select-Object` cmdlet that displays the 100 newest events.</span></span>

### <span data-ttu-id="7a3ae-239">例 14: イベントトレースログからイベントを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-239">Example 14: Get events from an event trace log</span></span>

<span data-ttu-id="7a3ae-240">この例では、イベントトレースログファイル ( `.etl` ) およびアーカイブ済みの Windows PowerShell ログファイル () からイベントを取得する方法を示し `.evtx` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-240">This example shows how to get the events from an event trace log file (`.etl`) and an archived Windows PowerShell log file (`.evtx`).</span></span> <span data-ttu-id="7a3ae-241">1 つのコマンドで複数のファイルの種類を組み合わせることができます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-241">You can combine multiple file types in a single command.</span></span>
<span data-ttu-id="7a3ae-242">ファイルには同じ種類の **.NET Framework** オブジェクト **EventLogRecord** が含まれているため、同じプロパティを使用してそれらをフィルター処理できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-242">Because the files contain the same type of **.NET Framework** object, **EventLogRecord** , you can filter them with the same properties.</span></span> <span data-ttu-id="7a3ae-243">コマンドはファイルから読み取るため、 **最も古い** パラメーターを必要とし `.etl` ますが、 **最も古い** パラメーターは各ファイルに適用されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-243">The command requires the **Oldest** parameter because it is reading from an `.etl` file, but the **Oldest** parameter applies to each file.</span></span>

```powershell
Get-WinEvent -Path 'C:\Tracing\TraceLog.etl', 'C:\Test\Windows PowerShell.evtx' -Oldest |
  Where-Object { $_.Id -eq '403' }
```

<span data-ttu-id="7a3ae-244">コマンドレットは、アーカイブされ `Get-WinEvent` たファイルからログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-244">The `Get-WinEvent` cmdlet gets log information from the archived files.</span></span> <span data-ttu-id="7a3ae-245">**Path** パラメーターでは、コンマ区切りの一覧を使用して、各ファイルのディレクトリとファイル名を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-245">The **Path** parameter uses a comma-separated list to specify each files directory and file name.</span></span> <span data-ttu-id="7a3ae-246">**最も古い** パラメーターは、イベントが書き込まれた順序でイベントを出力するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-246">The **Oldest** parameter is used to output events in the order they are written, oldest to newest.</span></span> <span data-ttu-id="7a3ae-247">オブジェクトは、パイプラインを介してコマンドレットに送信され `Where-Object` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-247">The objects are sent down the pipeline to the `Where-Object` cmdlet.</span></span> <span data-ttu-id="7a3ae-248">`Where-Object` スクリプトブロックを使用して、および **Id** **403** のイベントを検索します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-248">`Where-Object` uses a script block to find events with and **Id** of **403**.</span></span> <span data-ttu-id="7a3ae-249">変数は、 `$_` パイプライン内の現在のオブジェクトを表し、 **Id** はイベント id プロパティです。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-249">The `$_` variable represents the current object in the pipeline and **Id** is the Event Id property.</span></span>

### <span data-ttu-id="7a3ae-250">例 15: イベントログの結果をフィルター処理する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-250">Example 15: Filter event log results</span></span>

<span data-ttu-id="7a3ae-251">この例は、イベントログからイベントをフィルター処理および選択するためのさまざまなメソッドを示しています。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-251">This example shows a variety of methods to filter and select events from an event log.</span></span> <span data-ttu-id="7a3ae-252">これらのコマンドはすべて、 **Windows PowerShell** イベントログから過去24時間以内に発生したイベントを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-252">All of these commands get events that occurred in the last 24-hours from the **Windows PowerShell** event log.</span></span>
<span data-ttu-id="7a3ae-253">フィルターメソッドは、コマンドレットを使用するよりも効率的です `Where-Object` 。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-253">The filter methods are more efficient than using the `Where-Object` cmdlet.</span></span> <span data-ttu-id="7a3ae-254">フィルターは、オブジェクトの取得時に適用されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-254">Filters are applied as the objects are retrieved.</span></span> <span data-ttu-id="7a3ae-255">`Where-Object` すべてのオブジェクトを取得し、すべてのオブジェクトにフィルターを適用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-255">`Where-Object` retrieves all of the objects, then applies filters to all of the objects.</span></span>

```powershell
# Using the Where-Object cmdlet:
$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
Get-WinEvent -LogName 'Windows PowerShell' | Where-Object { $_.TimeCreated -ge $Yesterday }

# Using the FilterHashtable parameter:
$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
Get-WinEvent -FilterHashtable @{ LogName='Windows PowerShell'; Level=3; StartTime=$Yesterday }

# Using the FilterXML parameter:
$xmlQuery = @'
<QueryList>
  <Query Id="0" Path="Windows PowerShell">
    <Select Path="System">*[System[(Level=3) and
        TimeCreated[timediff(@SystemTime) &lt;= 86400000]]]</Select>
  </Query>
</QueryList>
'@
Get-WinEvent -FilterXML $xmlQuery

# Using the FilterXPath parameter:
$XPath = '*[System[Level=3 and TimeCreated[timediff(@SystemTime) &lt;= 86400000]]]'
Get-WinEvent -LogName 'Windows PowerShell' -FilterXPath $XPath
```

### <span data-ttu-id="7a3ae-256">例 16: FilterHashtable を使用してアプリケーションログからイベントを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-256">Example 16: Use FilterHashtable to get events from the Application log</span></span>

<span data-ttu-id="7a3ae-257">この例では、 **Filterhashtable** パラメーターを使用して、 **アプリケーション** ログからイベントを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-257">This example uses the **FilterHashtable** parameter to get events from the **Application** log.</span></span> <span data-ttu-id="7a3ae-258">ハッシュテーブルでは、 **キーと値** のペアが使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-258">The hash table uses **key/value** pairs.</span></span> <span data-ttu-id="7a3ae-259">**Filterhashtable** パラメーターの詳細については、「 [filterhashtable を使用した Get-WinEvent クエリの作成](/powershell/scripting/samples/Creating-Get-WinEvent-queries-with-FilterHashtable)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-259">For more information about the **FilterHashtable** parameter, see [Creating Get-WinEvent queries with FilterHashtable](/powershell/scripting/samples/Creating-Get-WinEvent-queries-with-FilterHashtable).</span></span>
<span data-ttu-id="7a3ae-260">ハッシュ テーブルの詳細については、「[about_Hash_Tables (ハッシュ テーブルについて)](../Microsoft.PowerShell.Core/about/about_hash_tables.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-260">For more information about hash tables, see [about_Hash_Tables](../Microsoft.PowerShell.Core/about/about_hash_tables.md).</span></span>

```powershell
$Date = (Get-Date).AddDays(-2)
Get-WinEvent -FilterHashtable @{ LogName='Application'; StartTime=$Date; Id='1003' }
```

<span data-ttu-id="7a3ae-261">この `Get-Date` コマンドレットは、 **AddDays** メソッドを使用して、現在の日付の2日前の日付を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-261">The `Get-Date` cmdlet uses the **AddDays** method to get a date that is two days before the current date.</span></span> <span data-ttu-id="7a3ae-262">Date オブジェクトは変数に格納され `$Date` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-262">The date object is stored in the `$Date` variable.</span></span>

<span data-ttu-id="7a3ae-263">コマンドレットでは、 `Get-WinEvent` ログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-263">The `Get-WinEvent` cmdlet gets log information.</span></span> <span data-ttu-id="7a3ae-264">**Filterhashtable** パラメーターは、出力をフィルター処理するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-264">The **FilterHashtable** parameter is used to filter the output.</span></span> <span data-ttu-id="7a3ae-265">**LogName** キーは、 **アプリケーション** ログとして値を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-265">The **LogName** key specifies the value as the **Application** log.</span></span> <span data-ttu-id="7a3ae-266">**StartTime** キーは、変数に格納されている値を使用し `$Date` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-266">The **StartTime** key uses the value stored in the `$Date` variable.</span></span> <span data-ttu-id="7a3ae-267">**Id** キーは、イベント id 値 **1003** を使用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-267">The **Id** key uses an Event Id value, **1003**.</span></span>

### <span data-ttu-id="7a3ae-268">例 17: FilterHashtable を使用してアプリケーションエラーを取得する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-268">Example 17: Use FilterHashtable to get application errors</span></span>

<span data-ttu-id="7a3ae-269">この例では、 **Filterhashtable** パラメーターを使用して、先週に発生した Internet Explorer のアプリケーションエラーを検索します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-269">This example uses the **FilterHashtable** parameter to find Internet Explorer application errors that occurred within the last week.</span></span>

```powershell
$StartTime = (Get-Date).AddDays(-7)
Get-WinEvent -FilterHashtable @{
  Logname='Application'
  ProviderName='Application Error'
  Data='iexplore.exe'
  StartTime=$StartTime
}
```

<span data-ttu-id="7a3ae-270">この `Get-Date` コマンドレットは、 **AddDays** メソッドを使用して、現在の日付の7日前の日付を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-270">The `Get-Date` cmdlet uses the **AddDays** method to get a date that is seven days before the current date.</span></span> <span data-ttu-id="7a3ae-271">Date オブジェクトは変数に格納され `$StartTime` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-271">The date object is stored in the `$StartTime` variable.</span></span>

<span data-ttu-id="7a3ae-272">コマンドレットでは、 `Get-WinEvent` ログ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-272">The `Get-WinEvent` cmdlet gets log information.</span></span> <span data-ttu-id="7a3ae-273">**Filterhashtable** パラメーターは、出力をフィルター処理するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-273">The **FilterHashtable** parameter is used to filter the output.</span></span> <span data-ttu-id="7a3ae-274">**LogName** キーは、 **アプリケーション** ログとして値を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-274">The **LogName** key specifies the value as the **Application** log.</span></span> <span data-ttu-id="7a3ae-275">**ProviderName** キーは、イベントの **ソース** である、 **アプリケーションエラー** という値を使用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-275">The **ProviderName** key uses the value, **Application Error** , which is the event's **Source**.</span></span> <span data-ttu-id="7a3ae-276">**データ** キーは値を使用 **iexplore.exe** しiexplore.exe **StartTime** キーは変数に格納されている値を使用し `$StartTime` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-276">The **Data** key uses the value **iexplore.exe** The **StartTime** key uses the value stored in `$StartTime` variable.</span></span>

### <span data-ttu-id="7a3ae-277">例 18: SuppressHashFilter を使用してアプリケーションエラーをフィルター処理する</span><span class="sxs-lookup"><span data-stu-id="7a3ae-277">Example 18: Use SuppressHashFilter to filter application errors</span></span>

<span data-ttu-id="7a3ae-278">上の例16と同様に、この例では、 **Filterhashtable** パラメーターを使用して、 **アプリケーション** ログからイベントを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-278">Like Example 16 above, this example uses the **FilterHashtable** parameter to get events from the **Application** log.</span></span> <span data-ttu-id="7a3ae-279">ただし、 **情報** レベルのイベントを除外するには、 **SuppressHashFilter** キーを追加します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-279">However, we add the **SuppressHashFilter** key to filter out **Information** level events.</span></span>

```powershell
$Date = (Get-Date).AddDays(-2)
$filter = @{
  LogName='Application'
  StartTime=$Date
  SuppressHashFilter=@{Level=4}
}
Get-WinEvent -FilterHashtable $filter
```

<span data-ttu-id="7a3ae-280">この例では、は、 `Get-WinEvent` **レベル** 4 (情報) を持つイベントを除いて、 **アプリケーション** ログからすべてのイベントを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-280">In this example, `Get-WinEvent` gets all events from the **Application** log for the last two days except those that have a **Level** of 4 (Information).</span></span>

## <span data-ttu-id="7a3ae-281">PARAMETERS</span><span class="sxs-lookup"><span data-stu-id="7a3ae-281">PARAMETERS</span></span>

### <span data-ttu-id="7a3ae-282">-ComputerName</span><span class="sxs-lookup"><span data-stu-id="7a3ae-282">-ComputerName</span></span>

<span data-ttu-id="7a3ae-283">このコマンドレットがイベントログからイベントを取得するコンピューターの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-283">Specifies the name of the computer that this cmdlet gets events from the event logs.</span></span> <span data-ttu-id="7a3ae-284">コンピューターの NetBIOS 名、IP アドレス、または完全修飾ドメイン名 (FQDN) を入力します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-284">Type the NetBIOS name, an IP address, or the fully qualified domain name (FQDN) of the computer.</span></span> <span data-ttu-id="7a3ae-285">既定値はローカルコンピューター **localhost** です。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-285">The default value is the local computer, **localhost**.</span></span> <span data-ttu-id="7a3ae-286">このパラメーターは、一度に 1 つのみコンピューター名を受け入れます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-286">This parameter accepts only one computer name at a time.</span></span>

<span data-ttu-id="7a3ae-287">リモートコンピューターからイベントログを取得するには、リモートアクセスを許可するようにイベントログサービスのファイアウォールポートを構成します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-287">To get event logs from remote computers, configure the firewall port for the event log service to allow remote access.</span></span>

<span data-ttu-id="7a3ae-288">このコマンドレットは、PowerShell リモート処理に依存しません。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-288">This cmdlet does not rely on PowerShell remoting.</span></span> <span data-ttu-id="7a3ae-289">コンピューターがリモート コマンドを実行するように構成されていない場合でも、 **ComputerName** パラメーターを使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-289">You can use the **ComputerName** parameter even if your computer is not configured to run remote commands.</span></span>

```yaml
Type: System.String
Parameter Sets: GetLogSet, ListLogSet, ListProviderSet, GetProviderSet, HashQuerySet, XmlQuerySet
Aliases: Cn

Required: False
Position: Named
Default value: Local computer
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="7a3ae-290">-Credential</span><span class="sxs-lookup"><span data-stu-id="7a3ae-290">-Credential</span></span>

<span data-ttu-id="7a3ae-291">この処理を実行するアクセス許可を持つユーザー アカウントを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-291">Specifies a user account that has permission to perform this action.</span></span> <span data-ttu-id="7a3ae-292">既定値は現在のユーザーです。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-292">The default value is the current user.</span></span>

<span data-ttu-id="7a3ae-293">**User01** や **domain01\user01」** などのユーザー名を入力します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-293">Type a user name, such as **User01** or **Domain01\User01**.</span></span> <span data-ttu-id="7a3ae-294">または、コマンドレットによって生成されるような **PSCredential** オブジェクトを入力し `Get-Credential` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-294">Or, enter a **PSCredential** object, such as one generated by the `Get-Credential` cmdlet.</span></span> <span data-ttu-id="7a3ae-295">ユーザー名を入力すると、パスワードの入力を求めるメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-295">If you type a user name, you are prompted for a password.</span></span> <span data-ttu-id="7a3ae-296">パラメーター名のみを入力した場合は、ユーザー名とパスワードの両方を入力するように求められます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-296">If you type only the parameter name, you are prompted for both a username and a password.</span></span>

```yaml
Type: System.Management.Automation.PSCredential
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: Current user
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="7a3ae-297">-FilterHashtable</span><span class="sxs-lookup"><span data-stu-id="7a3ae-297">-FilterHashtable</span></span>

<span data-ttu-id="7a3ae-298">1つ以上のイベントログからイベントを選択するために、ハッシュテーブル形式でクエリを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-298">Specifies a query in hash table format to select events from one or more event logs.</span></span> <span data-ttu-id="7a3ae-299">このクエリには、1つまたは複数の **キーと値** のペアを持つハッシュテーブルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-299">The query contains a hash table with one or more **key/value** pairs.</span></span>

<span data-ttu-id="7a3ae-300">ハッシュ テーブル クエリには、次のルールがあります。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-300">Hash table queries have the following rules:</span></span>

- <span data-ttu-id="7a3ae-301">キーと値では大文字と小文字が区別されません。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-301">Keys and values are case-insensitive.</span></span>
- <span data-ttu-id="7a3ae-302">ワイルドカード文字は、 **LogName** および **ProviderName** キーに関連付けられている値でのみ有効です。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-302">Wildcard characters are valid only in the values associated with the **LogName** and **ProviderName** keys.</span></span>
- <span data-ttu-id="7a3ae-303">各キーは、各ハッシュテーブルに1回だけ表示できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-303">Each key can be listed only once in each hash table.</span></span>
- <span data-ttu-id="7a3ae-304">**パス** の値には `.etl` 、、、およびの各ログファイルへのパスを指定し `.evt` `.evtx` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-304">The **Path** value takes paths to `.etl`, `.evt`, and `.evtx` log files.</span></span>
- <span data-ttu-id="7a3ae-305">**LogName** 、 **Path** 、および **ProviderName** キーは、同じクエリで使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-305">The **LogName** , **Path** , and **ProviderName** keys can be used in the same query.</span></span>
- <span data-ttu-id="7a3ae-306">**UserID** キーは有効なセキュリティ識別子 (SID) またはドメインアカウント名を受け取ることができます。この名前は、有効な **system.object オブジェクト** を構築するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-306">The **UserID** key can take a valid security identifier (SID) or a domain account name that can be used to construct a valid **System.Security.Principal.NTAccount object**.</span></span>
- <span data-ttu-id="7a3ae-307">**データ** 値は、名前のないフィールドでイベントデータを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-307">The **Data** value takes event data in an unnamed field.</span></span> <span data-ttu-id="7a3ae-308">たとえば、従来のイベントログのイベントです。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-308">For example, events in classic event logs.</span></span>
- <span data-ttu-id="7a3ae-309">`<named-data>` キーは、名前付きイベントデータフィールドを表します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-309">`<named-data>` key represents a named event data field.</span></span>

<span data-ttu-id="7a3ae-310">`Get-WinEvent`は、 **キーと値** のペアを解釈できない場合、イベント内のイベントデータに対して、大文字と小文字が区別される名前としてキーを解釈します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-310">When `Get-WinEvent` cannot interpret a **key/value** pair, it interprets the key as a case-sensitive name for the event data in the event.</span></span>

<span data-ttu-id="7a3ae-311">有効な `Get-WinEvent` **キーと値** のペアは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-311">The valid `Get-WinEvent` **key/value** pairs are as follows:</span></span>

- <span data-ttu-id="7a3ae-312">**/L**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-312">**LogName**=`<String[]>`</span></span>
- <span data-ttu-id="7a3ae-313">**プロバイダー**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-313">**ProviderName**=`<String[]>`</span></span>
- <span data-ttu-id="7a3ae-314">**道**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-314">**Path**=`<String[]>`</span></span>
- <span data-ttu-id="7a3ae-315">**Keywords**=`<Long[]>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-315">**Keywords**=`<Long[]>`</span></span>
- <span data-ttu-id="7a3ae-316">**番号**=`<Int32[]>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-316">**ID**=`<Int32[]>`</span></span>
- <span data-ttu-id="7a3ae-317">**平準**=`<Int32[]>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-317">**Level**=`<Int32[]>`</span></span>
- <span data-ttu-id="7a3ae-318">**/St**=`<DateTime>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-318">**StartTime**=`<DateTime>`</span></span>
- <span data-ttu-id="7a3ae-319">**EndTime**=`<DateTime>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-319">**EndTime**=`<DateTime>`</span></span>
- <span data-ttu-id="7a3ae-320">**UserID**=`<SID>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-320">**UserID**=`<SID>`</span></span>
- <span data-ttu-id="7a3ae-321">**データ**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-321">**Data**=`<String[]>`</span></span>
- `<named-data>`=`<String[]>`
- <span data-ttu-id="7a3ae-322">**SuppressHashFilter**=`<Hashtable>`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-322">**SuppressHashFilter**=`<Hashtable>`</span></span>

```yaml
Type: System.Collections.Hashtable[]
Parameter Sets: HashQuerySet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="7a3ae-323">-FilterXml</span><span class="sxs-lookup"><span data-stu-id="7a3ae-323">-FilterXml</span></span>

<span data-ttu-id="7a3ae-324">このコマンドレットが1つ以上のイベントログからイベントを選択する構造化 XML クエリを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-324">Specifies a structured XML query that this cmdlet selects events from one or more event logs.</span></span>

<span data-ttu-id="7a3ae-325">有効な XML クエリを生成するには、Windows イベントビューアーの [ **カスタムビューの作成** ] と [ **現在のログをフィルター** ] 機能を使用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-325">To generate a valid XML query, use the **Create Custom View** and **Filter Current Log** features in Windows Event Viewer.</span></span> <span data-ttu-id="7a3ae-326">ダイアログ ボックス内の項目を使用してクエリを作成し、その後、[XML] タブをクリックして XML 形式でクエリを表示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-326">Use the items in the dialog box to create a query, and then click the XML tab to view the query in XML format.</span></span> <span data-ttu-id="7a3ae-327">[XML] タブから **FilterXml** パラメーターの値に XML をコピーできます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-327">You can copy the XML from the XML tab into the value of the **FilterXml** parameter.</span></span> <span data-ttu-id="7a3ae-328">イベント ビューアーの機能の詳細については、イベント ビューアーのヘルプを参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-328">For more information about the Event Viewer features, see Event Viewer Help.</span></span>

<span data-ttu-id="7a3ae-329">XML クエリを使用して、いくつかの XPath ステートメントを含む複雑なクエリを作成します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-329">Use an XML query to create a complex query that contains several XPath statements.</span></span> <span data-ttu-id="7a3ae-330">XML 形式では、クエリからのイベントを除外する非表示の **xml** 要素を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-330">The XML format also allows you to use a **Suppress XML** element that excludes events from the query.</span></span> <span data-ttu-id="7a3ae-331">イベントログクエリの XML スキーマの詳細については、「 [クエリスキーマ](/windows/win32/wes/queryschema-schema) 」および「 [イベントの選択](/previous-versions/aa385231(v=vs.85))」の「xml イベントクエリ」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-331">For more information about the XML schema for event log queries, see [Query Schema](/windows/win32/wes/queryschema-schema) and the XML Event Queries section of [Event Selection](/previous-versions/aa385231(v=vs.85)).</span></span>

<span data-ttu-id="7a3ae-332">**Filterhashtable** パラメーターを使用して、 **抑制** 要素を作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-332">You may also create a **Suppress** element using the **FilterHashtable** parameter.</span></span>

```yaml
Type: System.Xml.XmlDocument
Parameter Sets: XmlQuerySet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="7a3ae-333">-FilterXPath</span><span class="sxs-lookup"><span data-stu-id="7a3ae-333">-FilterXPath</span></span>

<span data-ttu-id="7a3ae-334">このコマンドレットが1つ以上のログからイベントを選択する XPath クエリを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-334">Specifies an XPath query that this cmdlet select events from one or more logs.</span></span>

<span data-ttu-id="7a3ae-335">XPath 言語の詳細については、「 [Xpath リファレンス](/previous-versions/dotnet/netframework-4.0/ms256115(v=vs.100)) 」および「イベントの [選択](/previous-versions/aa385231(v=vs.85))」の選択フィルターに関するセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-335">For more information about the XPath language, see [XPath Reference](/previous-versions/dotnet/netframework-4.0/ms256115(v=vs.100)) and the Selection Filters section of [Event Selection](/previous-versions/aa385231(v=vs.85)).</span></span>

```yaml
Type: System.String
Parameter Sets: GetLogSet, GetProviderSet, FileSet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="7a3ae-336">-Force</span><span class="sxs-lookup"><span data-stu-id="7a3ae-336">-Force</span></span>

<span data-ttu-id="7a3ae-337">その他のイベント ログに加え、デバッグ ログと分析ログを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-337">Gets debug and analytic logs, in addition to other event logs.</span></span> <span data-ttu-id="7a3ae-338">**Force** パラメーターは、Name パラメーターにワイルドカード文字が含まれる場合に、デバッグ ログと分析ログを取得するために必要です。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-338">The **Force** parameter is required to get a debug or analytic log when the value of the name parameter includes wildcard characters.</span></span>

<span data-ttu-id="7a3ae-339">既定では、 `Get-WinEvent` コマンドレットは、デバッグログまたは分析ログの完全な名前を指定しない限り、これらのログを除外します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-339">By default, the `Get-WinEvent` cmdlet excludes these logs unless you specify the full name of a debug or analytic log.</span></span>

```yaml
Type: System.Management.Automation.SwitchParameter
Parameter Sets: GetLogSet, ListLogSet, GetProviderSet, HashQuerySet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="7a3ae-340">-ListLog</span><span class="sxs-lookup"><span data-stu-id="7a3ae-340">-ListLog</span></span>

<span data-ttu-id="7a3ae-341">イベント ログを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-341">Specifies the event logs.</span></span> <span data-ttu-id="7a3ae-342">コンマ区切りの一覧で、イベント ログ名を入力します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-342">Enter the event log names in a comma-separated list.</span></span> <span data-ttu-id="7a3ae-343">ワイルドカードを使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-343">Wildcards are permitted.</span></span> <span data-ttu-id="7a3ae-344">すべてのログを取得するには、アスタリスク ( `*` ) ワイルドカードを使用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-344">To get all the logs, use the asterisk (`*`) wildcard.</span></span>

```yaml
Type: System.String[]
Parameter Sets: ListLogSet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: True
```

### <span data-ttu-id="7a3ae-345">-ListProvider</span><span class="sxs-lookup"><span data-stu-id="7a3ae-345">-ListProvider</span></span>

<span data-ttu-id="7a3ae-346">このコマンドレットが取得するイベントログプロバイダーを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-346">Specifies the event log providers that this cmdlet gets.</span></span> <span data-ttu-id="7a3ae-347">イベント ログ プロバイダーは、イベント ログにイベントを書き込むプログラムまたはサービスです。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-347">An event log provider is a program or service that writes events to the event log.</span></span>

<span data-ttu-id="7a3ae-348">コンマ区切りの一覧でプロバイダー名を入力します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-348">Enter the provider names in a comma-separated list.</span></span> <span data-ttu-id="7a3ae-349">ワイルドカードを使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-349">Wildcards are permitted.</span></span> <span data-ttu-id="7a3ae-350">コンピューター上のすべてのイベントログのプロバイダーを取得するには、アスタリスク ( `*` ) ワイルドカードを使用します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-350">To get the providers of all the event logs on the computer, use the asterisk (`*`) wildcard.</span></span>

```yaml
Type: System.String[]
Parameter Sets: ListProviderSet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: True
```

### <span data-ttu-id="7a3ae-351">-LogName</span><span class="sxs-lookup"><span data-stu-id="7a3ae-351">-LogName</span></span>

<span data-ttu-id="7a3ae-352">このコマンドレットがイベントを取得するイベントログを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-352">Specifies the event logs that this cmdlet get events from.</span></span> <span data-ttu-id="7a3ae-353">コンマ区切りの一覧で、イベント ログ名を入力します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-353">Enter the event log names in a comma-separated list.</span></span> <span data-ttu-id="7a3ae-354">ワイルドカードを使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-354">Wildcards are permitted.</span></span> <span data-ttu-id="7a3ae-355">また、ログ名をコマンドレットにパイプすることもでき `Get-WinEvent` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-355">You can also pipe log names to the `Get-WinEvent` cmdlet.</span></span>

> [!NOTE]
> <span data-ttu-id="7a3ae-356">PowerShell では、要求できるログの量が制限されていません。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-356">PowerShell does not limit the amount of logs you can request.</span></span> <span data-ttu-id="7a3ae-357">ただし、この `Get-WinEvent` コマンドレットは、制限が256の WINDOWS API を照会します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-357">However, the `Get-WinEvent` cmdlet queries the Windows API which has a limit of 256.</span></span> <span data-ttu-id="7a3ae-358">これにより、すべてのログを一度にフィルター処理するのが困難になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-358">This can make it difficult to filter through all of your logs at one time.</span></span> <span data-ttu-id="7a3ae-359">この問題を回避するには、ループを使用して、次 `foreach` のように各ログを反復処理します。 `Get-WinEvent -ListLog * | ForEach-Object{ Get-WinEvent -LogName $_.Logname }`</span><span class="sxs-lookup"><span data-stu-id="7a3ae-359">You can work around this by using a `foreach` loop to iterate through each log like this: `Get-WinEvent -ListLog * | ForEach-Object{ Get-WinEvent -LogName $_.Logname }`</span></span>

```yaml
Type: System.String[]
Parameter Sets: GetLogSet
Aliases:

Required: False
Position: 0
Default value: None
Accept pipeline input: True (ByPropertyName, ByValue)
Accept wildcard characters: True
```

### <span data-ttu-id="7a3ae-360">-MaxEvents</span><span class="sxs-lookup"><span data-stu-id="7a3ae-360">-MaxEvents</span></span>

<span data-ttu-id="7a3ae-361">返されるイベントの最大数を指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-361">Specifies the maximum number of events that are returned.</span></span> <span data-ttu-id="7a3ae-362">100などの整数を入力します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-362">Enter an integer such as 100.</span></span> <span data-ttu-id="7a3ae-363">既定では、ログやファイル内のすべてのイベントを返します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-363">The default is to return all the events in the logs or files.</span></span>

```yaml
Type: System.Int64
Parameter Sets: GetLogSet, GetProviderSet, FileSet, HashQuerySet, XmlQuerySet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="7a3ae-364">-最も古い</span><span class="sxs-lookup"><span data-stu-id="7a3ae-364">-Oldest</span></span>

<span data-ttu-id="7a3ae-365">このコマンドレットが、古い順にイベントを取得することを示します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-365">Indicate that this cmdlet gets the events in oldest-first order.</span></span> <span data-ttu-id="7a3ae-366">既定では、イベントは新しい順に返されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-366">By default, events are returned in newest-first order.</span></span>

<span data-ttu-id="7a3ae-367">このパラメーターは、およびファイルからイベントを取得し、 `.etl` `.evt` デバッグログと分析ログからイベントを取得するために必要です。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-367">This parameter is required to get events from `.etl` and `.evt` files and from debug and analytic logs.</span></span> <span data-ttu-id="7a3ae-368">これらのファイルでは、イベントは古い順に記録され、イベントは古い順でのみ返すことができます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-368">In these files, events are recorded in oldest-first order, and the events can be returned only in oldest-first order.</span></span>

```yaml
Type: System.Management.Automation.SwitchParameter
Parameter Sets: GetLogSet, GetProviderSet, FileSet, HashQuerySet, XmlQuerySet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="7a3ae-369">-Path</span><span class="sxs-lookup"><span data-stu-id="7a3ae-369">-Path</span></span>

<span data-ttu-id="7a3ae-370">このコマンドレットがイベントを取得するイベントログファイルのパスを指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-370">Specifies the path to the event log files that this cmdlet get events from.</span></span> <span data-ttu-id="7a3ae-371">コンマ区切りの一覧でログ ファイルへのパスを入力するか、ワイルドカード文字を使用してファイル パス パターンを作成します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-371">Enter the paths to the log files in a comma-separated list, or use wildcard characters to create file path patterns.</span></span>

<span data-ttu-id="7a3ae-372">`Get-WinEvent` は、、 `.evt` `.evtx` 、およびファイル名拡張子を持つファイルをサポートし `.etl` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-372">`Get-WinEvent` supports files with the `.evt`, `.evtx`, and `.etl` file name extensions.</span></span> <span data-ttu-id="7a3ae-373">同じコマンドで、異なるファイルおよびファイルの種類からのイベントを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-373">You can include events from different files and file types in the same command.</span></span>

```yaml
Type: System.String[]
Parameter Sets: FileSet
Aliases: PSPath

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: True
```

### <span data-ttu-id="7a3ae-374">-ProviderName</span><span class="sxs-lookup"><span data-stu-id="7a3ae-374">-ProviderName</span></span>

<span data-ttu-id="7a3ae-375">このコマンドレットがイベントを取得するイベントログプロバイダーを文字列配列として指定します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-375">Specifies, as a string array, the event log providers from which this cmdlet gets events.</span></span> <span data-ttu-id="7a3ae-376">コンマ区切りの一覧でプロバイダー名を入力するか、ワイルドカード文字を使用してプロバイダー名パターンを作成します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-376">Enter the provider names in a comma-separated list, or use wildcard characters to create provider name patterns.</span></span>

<span data-ttu-id="7a3ae-377">イベント ログ プロバイダーは、イベント ログにイベントを書き込むプログラムまたはサービスです。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-377">An event log provider is a program or service that writes events to the event log.</span></span> <span data-ttu-id="7a3ae-378">PowerShell プロバイダーではありません。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-378">It is not a PowerShell provider.</span></span>

```yaml
Type: System.String[]
Parameter Sets: GetProviderSet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: True
```

### <span data-ttu-id="7a3ae-379">共通パラメーター</span><span class="sxs-lookup"><span data-stu-id="7a3ae-379">CommonParameters</span></span>

<span data-ttu-id="7a3ae-380">このコマンドレットは、一般的なパラメーターをサポートしています。-Debug、-ErrorAction、-ErrorVariable、-InformationAction、-InformationVariable、-OutVariable、-OutBuffer、-PipelineVariable、-Verbose、-WarningAction、-WarningVariable です。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-380">This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable.</span></span> <span data-ttu-id="7a3ae-381">詳細については、「[about_CommonParameters](https://go.microsoft.com/fwlink/?LinkID=113216)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-381">For more information, see [about_CommonParameters](https://go.microsoft.com/fwlink/?LinkID=113216).</span></span>

## <span data-ttu-id="7a3ae-382">入力</span><span class="sxs-lookup"><span data-stu-id="7a3ae-382">INPUTS</span></span>

### <span data-ttu-id="7a3ae-383">System.string、System.Xml.Xmlドキュメント、System. Collections. Hashtable</span><span class="sxs-lookup"><span data-stu-id="7a3ae-383">System.String, System.Xml.XmlDocument, System.Collections.Hashtable</span></span>

<span data-ttu-id="7a3ae-384">では、 **LogName** (文字列)、 **filterxml** クエリ、または **filterxml** クエリをにパイプラインでき `Get-WinEvent` ます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-384">You can pipeline a **LogName** (string), a **FilterXML** query, or a **FilterHashtable** query to `Get-WinEvent`.</span></span>

## <span data-ttu-id="7a3ae-385">出力</span><span class="sxs-lookup"><span data-stu-id="7a3ae-385">OUTPUTS</span></span>

### <span data-ttu-id="7a3ae-386">EventLogConfiguration、EventLogRecord、、..................。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-386">System.Diagnostics.Eventing.Reader.EventLogConfiguration, System.Diagnostics.Eventing.Reader.EventLogRecord, System.Diagnostics.Eventing.Reader.ProviderMetadata</span></span>

<span data-ttu-id="7a3ae-387">**Listlog** パラメーターを指定すると、 `Get-WinEvent` **EventLogConfiguration** オブジェクトが返されます。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-387">With the **ListLog** parameter, `Get-WinEvent` returns **System.Diagnostics.Eventing.Reader.EventLogConfiguration** objects.</span></span>

<span data-ttu-id="7a3ae-388">**ListProvider** パラメーターを指定すると、は system.string `Get-WinEvent` **メタデータ** オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-388">With the **ListProvider** parameter, `Get-WinEvent` returns **System.Diagnostics.Eventing.Reader.ProviderMetadata** objects.</span></span>

<span data-ttu-id="7a3ae-389">他のすべてのパラメーターと共に、 `Get-WinEvent` **EventLogRecord** オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-389">With all other parameters, `Get-WinEvent` returns **System.Diagnostics.Eventing.Reader.EventLogRecord** objects.</span></span>

## <span data-ttu-id="7a3ae-390">注</span><span class="sxs-lookup"><span data-stu-id="7a3ae-390">NOTES</span></span>

<span data-ttu-id="7a3ae-391">`Get-WinEvent` は、 `Get-EventLog` Windows Vista 以降のバージョンの windows を実行しているコンピューターでコマンドレットを置き換えるように設計されています。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-391">`Get-WinEvent` is designed to replace the `Get-EventLog` cmdlet on computers running Windows Vista and later versions of Windows.</span></span> <span data-ttu-id="7a3ae-392">`Get-EventLog` 従来のイベントログでのみイベントを取得します。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-392">`Get-EventLog` gets events only in classic event logs.</span></span> <span data-ttu-id="7a3ae-393">`Get-EventLog` 関数は下位互換性のために残されています。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-393">`Get-EventLog` is retained for backward compatibility.</span></span>

<span data-ttu-id="7a3ae-394">`Get-WinEvent`および `Get-EventLog` コマンドレットは、Windows プレインストール環境 (windows PE) ではサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7a3ae-394">The `Get-WinEvent` and `Get-EventLog` cmdlets are not supported in Windows Pre-installation Environment (Windows PE).</span></span>

## <span data-ttu-id="7a3ae-395">関連リンク</span><span class="sxs-lookup"><span data-stu-id="7a3ae-395">RELATED LINKS</span></span>

[<span data-ttu-id="7a3ae-396">about_Automatic_Variables</span><span class="sxs-lookup"><span data-stu-id="7a3ae-396">about_Automatic_Variables</span></span>](../Microsoft.PowerShell.Core/about/about_automatic_variables.md)

[<span data-ttu-id="7a3ae-397">about_Foreach</span><span class="sxs-lookup"><span data-stu-id="7a3ae-397">about_Foreach</span></span>](../Microsoft.PowerShell.Core/about/about_Foreach.md)

[<span data-ttu-id="7a3ae-398">about_Hash_Tables</span><span class="sxs-lookup"><span data-stu-id="7a3ae-398">about_Hash_Tables</span></span>](../Microsoft.PowerShell.Core/about/about_hash_tables.md)

[<span data-ttu-id="7a3ae-399">FilterHashtable を使った Get-WinEvent クエリの作成</span><span class="sxs-lookup"><span data-stu-id="7a3ae-399">Creating Get-WinEvent queries with FilterHashtable</span></span>](/powershell/scripting/samples/Creating-Get-WinEvent-queries-with-FilterHashtable)

[<span data-ttu-id="7a3ae-400">Format-Table</span><span class="sxs-lookup"><span data-stu-id="7a3ae-400">Format-Table</span></span>](../Microsoft.PowerShell.Utility/Format-Table.md)

[<span data-ttu-id="7a3ae-401">Group-Object</span><span class="sxs-lookup"><span data-stu-id="7a3ae-401">Group-Object</span></span>](../Microsoft.PowerShell.Utility/Group-Object.md)

[<span data-ttu-id="7a3ae-402">Sort-Object</span><span class="sxs-lookup"><span data-stu-id="7a3ae-402">Sort-Object</span></span>](../Microsoft.PowerShell.Utility/Sort-Object.md)

[<span data-ttu-id="7a3ae-403">Where-Object</span><span class="sxs-lookup"><span data-stu-id="7a3ae-403">Where-Object</span></span>](../Microsoft.PowerShell.Core/Where-Object.md)
