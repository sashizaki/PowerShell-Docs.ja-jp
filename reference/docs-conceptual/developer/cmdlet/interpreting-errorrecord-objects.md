---
ms.date: 09/13/2016
ms.topic: reference
title: ErrorRecord オブジェクトを解釈する
description: ErrorRecord オブジェクトを解釈する
ms.openlocfilehash: 5a8556e0ba83e54dd197ed03665a119f0b565f2b
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2020
ms.locfileid: "92666877"
---
# <a name="interpreting-errorrecord-objects"></a><span data-ttu-id="01650-103">ErrorRecord オブジェクトを解釈する</span><span class="sxs-lookup"><span data-stu-id="01650-103">Interpreting ErrorRecord Objects</span></span>

<span data-ttu-id="01650-104">ほとんどの場合、 [System. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) オブジェクトは、コマンドまたはスクリプトによって生成される終了しないエラーを表します。</span><span class="sxs-lookup"><span data-stu-id="01650-104">In most cases, an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object represents a non-terminating error generated by a command or script.</span></span> <span data-ttu-id="01650-105">終了エラーでは、 [Icontainserrorrecord](/dotnet/api/System.Management.Automation.IContainsErrorRecord) インターフェイスを使用して、errorrecord 内の追加情報を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="01650-105">Terminating errors can also specify the additional information in an ErrorRecord via the [System.Management.Automation.Icontainserrorrecord](/dotnet/api/System.Management.Automation.IContainsErrorRecord) interface.</span></span>

<span data-ttu-id="01650-106">コマンドまたはスクリプトの実行中に発生した特定のエラーを処理するためのエラーハンドラーをスクリプトまたはホストに記述する場合は、処理するエラーのクラスを表すかどうかを判断するために、 [システムの管理](/dotnet/api/System.Management.Automation.ErrorRecord) オブジェクトを解釈する必要があります。</span><span class="sxs-lookup"><span data-stu-id="01650-106">If you want to write an error handler in your script or a host to handle specific errors that occur during command or script execution, you must interpret the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object to determine whether it represents the class of error that you want to handle.</span></span>

<span data-ttu-id="01650-107">コマンドレットで終了または終了しないエラーが発生した場合は、エラー状態を説明するエラーレコードを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="01650-107">When a cmdlet encounters a terminating or non-terminating error, it should create an error record that describes the error condition.</span></span> <span data-ttu-id="01650-108">ホストアプリケーションは、これらのエラーレコードを調査し、エラーを軽減する何らかのアクションを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="01650-108">The host application must investigate these error records and perform whatever action will mitigate the error.</span></span> <span data-ttu-id="01650-109">また、ホストアプリケーションは、レコードを処理できなかったが続行できた、終了しないエラーのエラーレコードを調査する必要があります。また、パイプラインの停止の原因となったエラーを終了するために、エラーレコードを調査する必要があります。</span><span class="sxs-lookup"><span data-stu-id="01650-109">The host application must also investigate error records for nonterminating errors that failed to process a record but were able to continue, and it must investigate error records for terminating errors that caused the pipeline to stop.</span></span>

> [!NOTE]
> <span data-ttu-id="01650-110">終了エラーの場合、コマンドレットは [Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="01650-110">For terminating errors, the cmdlet calls the [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method.</span></span> <span data-ttu-id="01650-111">終了しないエラーの場合、コマンドレットは [WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="01650-111">For non-terminating errors, the cmdlet calls the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method.</span></span>

## <a name="error-record-design"></a><span data-ttu-id="01650-112">エラーレコードのデザイン</span><span class="sxs-lookup"><span data-stu-id="01650-112">Error Record Design</span></span>

<span data-ttu-id="01650-113">エラーレコードは、各エラーレコードの結合された情報が一意であることを確認しながら、例外では利用できない追加のエラー情報を提供するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="01650-113">Error records are designed to provide additional error information that is not available in exceptions while ensuring that the combined information in each error record is unique.</span></span> <span data-ttu-id="01650-114">この一意性により、ホストアプリケーションはエラーレコードのさまざまな部分を検査して、ホストが実行する必要のあるエラー状況とアクションを識別できるようになります。</span><span class="sxs-lookup"><span data-stu-id="01650-114">This uniqueness allows the host application to inspect the different parts of the error record so that it can identify the error condition and the action the host must take.</span></span>

## <a name="interpreting-error-records"></a><span data-ttu-id="01650-115">エラーレコードの解釈</span><span class="sxs-lookup"><span data-stu-id="01650-115">Interpreting Error Records</span></span>

<span data-ttu-id="01650-116">エラーレコードのいくつかの部分を確認して、エラーを特定することができます。</span><span class="sxs-lookup"><span data-stu-id="01650-116">You can review several parts of the error record to identify the error.</span></span> <span data-ttu-id="01650-117">これらの部分は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="01650-117">These parts include the following:</span></span>

- <span data-ttu-id="01650-118">エラーカテゴリ</span><span class="sxs-lookup"><span data-stu-id="01650-118">The error category</span></span>

- <span data-ttu-id="01650-119">エラー例外</span><span class="sxs-lookup"><span data-stu-id="01650-119">The error exception</span></span>

- <span data-ttu-id="01650-120">完全修飾エラー識別子 (完全修飾 ID)</span><span class="sxs-lookup"><span data-stu-id="01650-120">The fully qualified error identifier (FQID)</span></span>

- <span data-ttu-id="01650-121">その他の情報</span><span class="sxs-lookup"><span data-stu-id="01650-121">Other information</span></span>

### <a name="the-error-category"></a><span data-ttu-id="01650-122">エラーカテゴリ</span><span class="sxs-lookup"><span data-stu-id="01650-122">The Error Category</span></span>

<span data-ttu-id="01650-123">エラーレコードのエラーカテゴリは、 [Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory) 列挙型によって提供される定義済み定数の1つです。</span><span class="sxs-lookup"><span data-stu-id="01650-123">The error category of the error record is one of the predefined constants provided by the [System.Management.Automation.Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span> <span data-ttu-id="01650-124">この情報は、[システム](/dotnet/api/System.Management.Automation.ErrorRecord)の管理. errorrecord オブジェクトの system.servicemodel [info](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo)プロパティを使用して取得できます ()。</span><span class="sxs-lookup"><span data-stu-id="01650-124">This information  is available through the [System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

<span data-ttu-id="01650-125">コマンドレットでは、CloseError、OpenError、InvalidType、ReadError、および WriteError の各カテゴリとその他のエラーカテゴリを指定できます。</span><span class="sxs-lookup"><span data-stu-id="01650-125">The cmdlet can specify the CloseError, OpenError, InvalidType, ReadError, and WriteError categories, and other error categories.</span></span> <span data-ttu-id="01650-126">ホストアプリケーションはエラーカテゴリを使用して、エラーのグループをキャプチャできます。</span><span class="sxs-lookup"><span data-stu-id="01650-126">The host application can use the error category to capture groups of errors.</span></span>

### <a name="the-exception"></a><span data-ttu-id="01650-127">例外</span><span class="sxs-lookup"><span data-stu-id="01650-127">The Exception</span></span>

<span data-ttu-id="01650-128">エラーレコードに含まれる例外はコマンドレットによって提供され、この例外は[、システムの](/dotnet/api/System.Management.Automation.ErrorRecord)管理. errorrecord オブジェクトの system.string [\*](/dotnet/api/System.Management.Automation.ErrorRecord.Exception)プロパティを介してアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="01650-128">The exception included in the error record is provided by the cmdlet and can be accessed through the [System.Management.Automation.ErrorRecord.Exception\*](/dotnet/api/System.Management.Automation.ErrorRecord.Exception) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

<span data-ttu-id="01650-129">ホストアプリケーションはキーワードを使用して、 `is` 例外が特定のクラスまたは派生クラスであることを識別できます。</span><span class="sxs-lookup"><span data-stu-id="01650-129">Host applications can use the `is` keyword to identify that the exception is of a specific class or of a derived class.</span></span> <span data-ttu-id="01650-130">次の例に示すように、例外の種類に分岐することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="01650-130">It is better to branch on the exception type, as shown in the following example.</span></span>

`if (MyNonTerminatingError.Exception is AccessDeniedException)`

<span data-ttu-id="01650-131">このようにして、派生クラスをキャッチします。</span><span class="sxs-lookup"><span data-stu-id="01650-131">This way, you catch the derived classes.</span></span> <span data-ttu-id="01650-132">ただし、例外が逆シリアル化されると、問題が発生します。</span><span class="sxs-lookup"><span data-stu-id="01650-132">However, there are problems if the exception is deserialized.</span></span>

### <a name="the-fqid"></a><span data-ttu-id="01650-133">すべての ID</span><span class="sxs-lookup"><span data-stu-id="01650-133">The FQID</span></span>

<span data-ttu-id="01650-134">この ID は、エラーを識別するために使用できる最も具体的な情報です。</span><span class="sxs-lookup"><span data-stu-id="01650-134">The FQID is the most specific information you can use to identify the error.</span></span> <span data-ttu-id="01650-135">これは、コマンドレットで定義された識別子、コマンドレットクラスの名前、およびエラーを報告したソースを含む文字列です。</span><span class="sxs-lookup"><span data-stu-id="01650-135">It is a string that includes a cmdlet-defined identifier, the name of the cmdlet class, and the source that reported the error.</span></span> <span data-ttu-id="01650-136">一般に、エラーレコードは、Windows イベントログのイベントレコードに似ています。</span><span class="sxs-lookup"><span data-stu-id="01650-136">In general, an error record is analogous to an event record of a Windows Event log.</span></span> <span data-ttu-id="01650-137">このような ID は、イベントレコードのクラス (*ログ名*、 *ソース*、 *イベント ID*) を識別する次の組に似ています。</span><span class="sxs-lookup"><span data-stu-id="01650-137">The FQID is analogous to the following tuple, which identifies the class of the event record: (*log name*, *source*, *event ID*).</span></span>

<span data-ttu-id="01650-138">使用できる ID は、1つの文字列として検査されるように設計されています。</span><span class="sxs-lookup"><span data-stu-id="01650-138">The FQID is designed to be inspected as a single string.</span></span> <span data-ttu-id="01650-139">ただし、エラー識別子がホストアプリケーションによって解析されるように設計されているケースもあります。</span><span class="sxs-lookup"><span data-stu-id="01650-139">However, cases exist in which the error identifier is designed to be parsed by the host application.</span></span> <span data-ttu-id="01650-140">次の例は、正しい形式の完全修飾エラー識別子です。</span><span class="sxs-lookup"><span data-stu-id="01650-140">The following example is a well-formed fully qualified error identifier.</span></span>

`CommandNotFoundException,Microsoft.PowerShell.Commands.GetCommandCommand.`

<span data-ttu-id="01650-141">前の例では、最初のトークンはエラー識別子であり、その後にコマンドレットクラスの名前が続きます。</span><span class="sxs-lookup"><span data-stu-id="01650-141">In the previous example, the first token is the error identifier, which is followed by the name of the cmdlet class.</span></span> <span data-ttu-id="01650-142">エラー識別子には、1つのトークンを指定することも、識別子を検査するときに分岐を許可するドット区切りの識別子を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="01650-142">The error identifier can be a single token, or it can be a dot-separated identifier that allows for branching on inspection of the identifier.</span></span> <span data-ttu-id="01650-143">エラー識別子に空白または句読点を使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="01650-143">Do not use white space or punctuation in the error identifier.</span></span> <span data-ttu-id="01650-144">コンマを使用しないことが特に重要です。Windows PowerShell では、識別子とコマンドレットのクラス名を区切るためにコンマが使用されます。</span><span class="sxs-lookup"><span data-stu-id="01650-144">It is especially important not to use a comma; a comma is used by Windows PowerShell to separate the identifier and the cmdlet class name.</span></span>

### <a name="other-information"></a><span data-ttu-id="01650-145">その他の情報</span><span class="sxs-lookup"><span data-stu-id="01650-145">Other Information</span></span>

<span data-ttu-id="01650-146">また [、エラー](/dotnet/api/System.Management.Automation.ErrorRecord) が発生した環境を説明する情報を提供することもできます。</span><span class="sxs-lookup"><span data-stu-id="01650-146">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object might also provide information that describes the environment in which the error occurred.</span></span> <span data-ttu-id="01650-147">この情報には、エラーの詳細、呼び出し情報、エラーが発生したときに処理されていた対象オブジェクトなどが含まれます。</span><span class="sxs-lookup"><span data-stu-id="01650-147">This information includes items such as error details, invocation information, and the target object that was being processed when the error occurred.</span></span> <span data-ttu-id="01650-148">この情報はホストアプリケーションにとって有用な場合がありますが、通常はエラーを識別するために使用されません。</span><span class="sxs-lookup"><span data-stu-id="01650-148">Although this information might be useful to the host application, it is not typically used to identify the error.</span></span> <span data-ttu-id="01650-149">この情報は、次のプロパティを使用して取得できます。</span><span class="sxs-lookup"><span data-stu-id="01650-149">This information is available through the following properties:</span></span>

[<span data-ttu-id="01650-150">システム管理. ErrorRecord. Errorrecord</span><span class="sxs-lookup"><span data-stu-id="01650-150">System.Management.Automation.ErrorRecord.ErrorDetails</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails)

[<span data-ttu-id="01650-151">InvocationInfo (システムの管理)</span><span class="sxs-lookup"><span data-stu-id="01650-151">System.Management.Automation.ErrorRecord.InvocationInfo</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord.InvocationInfo)

[<span data-ttu-id="01650-152">TargetObject (システムの管理)</span><span class="sxs-lookup"><span data-stu-id="01650-152">System.Management.Automation.ErrorRecord.TargetObject</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord.TargetObject)

## <a name="see-also"></a><span data-ttu-id="01650-153">参照</span><span class="sxs-lookup"><span data-stu-id="01650-153">See Also</span></span>

[<span data-ttu-id="01650-154">システムの管理. ErrorRecord</span><span class="sxs-lookup"><span data-stu-id="01650-154">System.Management.Automation.ErrorRecord</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord)

[<span data-ttu-id="01650-155">Errorcategory (システム管理)</span><span class="sxs-lookup"><span data-stu-id="01650-155">System.Management.Automation.Errorcategory</span></span>](/dotnet/api/System.Management.Automation.ErrorCategory)

[<span data-ttu-id="01650-156">システムの管理. Errorカテゴリの情報</span><span class="sxs-lookup"><span data-stu-id="01650-156">System.Management.Automation.Errorcategoryinfo</span></span>](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)

[<span data-ttu-id="01650-157">WriteError (システム管理)</span><span class="sxs-lookup"><span data-stu-id="01650-157">System.Management.Automation.Cmdlet.WriteError</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)

[<span data-ttu-id="01650-158">Throwterminatingerror \* のようになります。</span><span class="sxs-lookup"><span data-stu-id="01650-158">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)

[<span data-ttu-id="01650-159">終了しないエラーのレポートをコマンドレットに追加する</span><span class="sxs-lookup"><span data-stu-id="01650-159">Adding Non-Terminating Error Reporting to Your Cmdlet</span></span>](./adding-non-terminating-error-reporting-to-your-cmdlet.md)

[<span data-ttu-id="01650-160">Windows PowerShell エラー レポート</span><span class="sxs-lookup"><span data-stu-id="01650-160">Windows PowerShell Error Reporting</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="01650-161">Windows PowerShell コマンドレットの記述</span><span class="sxs-lookup"><span data-stu-id="01650-161">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
