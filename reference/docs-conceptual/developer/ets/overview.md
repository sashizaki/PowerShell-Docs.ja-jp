---
title: 拡張型システムの概要
ms.date: 07/09/2020
ms.topic: conceptual
ms.openlocfilehash: 82170bd7e8943f68141159a7ac964f9ec1b2cfbc
ms.sourcegitcommit: d26e2237397483c6333abcf4331bd82f2e72b4e3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/10/2020
ms.locfileid: "86217979"
---
# <a name="extended-type-system-overview"></a><span data-ttu-id="f3050-102">拡張型システムの概要</span><span class="sxs-lookup"><span data-stu-id="f3050-102">Extended Type System Overview</span></span>

<span data-ttu-id="f3050-103">PowerShell では、 **PSObject**オブジェクトを使用して、オブジェクトの型を2つの方法で拡張します。</span><span class="sxs-lookup"><span data-stu-id="f3050-103">PowerShell uses its **PSObject** object to extend the types of objects in two ways.</span></span> <span data-ttu-id="f3050-104">最初に、 **PSObject**オブジェクトは、特定のオブジェクトの種類のさまざまなビューを表示する方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3050-104">First, the **PSObject** object provides a way to show different views of specific object types.</span></span> <span data-ttu-id="f3050-105">これは、オブジェクトの適用されたビューの表示と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="f3050-105">This is referred to as showing an adapted view of an object.</span></span> <span data-ttu-id="f3050-106">次に、 **PSObject**オブジェクトを使用して、既存のオブジェクトにメンバーを追加する方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3050-106">Second, the **PSObject** object provides a way to add members to existing object.</span></span> <span data-ttu-id="f3050-107">また、既存のオブジェクト (ベースオブジェクトと呼ばれます) をラップすることによって、 **PSObject**オブジェクトは、スクリプトとコマンドレットの開発者がシェル内の .net オブジェクトを操作するために使用できる拡張型システムを提供します。</span><span class="sxs-lookup"><span data-stu-id="f3050-107">Together, by wrapping an existing object, referred to as the base object, the **PSObject** object provides an extended type system (ETS) that script and cmdlet developers can use to manipulate .NET objects within the shell.</span></span>

## <a name="cmdlet-and-script-development-issues"></a><span data-ttu-id="f3050-108">コマンドレットとスクリプトの開発に関する問題</span><span class="sxs-lookup"><span data-stu-id="f3050-108">Cmdlet and Script Development Issues</span></span>

<span data-ttu-id="f3050-109">は、次の2つの基本的な問題を解決します。</span><span class="sxs-lookup"><span data-stu-id="f3050-109">ETS resolves two fundamental issues:</span></span>

<span data-ttu-id="f3050-110">まず、一部の .NET オブジェクトには、コマンドレット間のデータとして動作するために必要な既定の動作がありません。</span><span class="sxs-lookup"><span data-stu-id="f3050-110">First, some .NET Objects do not have the necessary default behavior for acting as the data between cmdlets.</span></span>

- <span data-ttu-id="f3050-111">.NET オブジェクトの中には、"メタ" オブジェクト (WMI オブジェクト、ADO オブジェクト、XML オブジェクトなど) が含まれています。これらのオブジェクトには、メンバーが格納しているデータが記述されています。</span><span class="sxs-lookup"><span data-stu-id="f3050-111">Some .NET objects are "meta" objects (for example: WMI Objects, ADO objects, and XML objects) whose members describe the data they contain.</span></span> <span data-ttu-id="f3050-112">ただし、スクリプト環境では、格納されているデータの説明ではなく、最も興味深いデータになります。</span><span class="sxs-lookup"><span data-stu-id="f3050-112">However, in a scripting environment it is the contained data that is most interesting, not the description of the contained data.</span></span> <span data-ttu-id="f3050-113">この問題を解決するには、基になる .NET オブジェクトを適合させるアダプターの概念を導入し、期待される既定のセマンティクスを持つようにします。</span><span class="sxs-lookup"><span data-stu-id="f3050-113">ETS resolves this issue by introducing the notion of Adapters that adapt the underlying .NET object to have the expected default semantics.</span></span>
- <span data-ttu-id="f3050-114">一部の .NET オブジェクトメンバーの名前が一貫していないか、パブリックメンバーのセットが不十分であるか、または機能が不十分です。</span><span class="sxs-lookup"><span data-stu-id="f3050-114">Some .NET Object members are inconsistently named, provide an insufficient set of public members, or provide insufficient capability.</span></span> <span data-ttu-id="f3050-115">では、追加メンバーを使用して .NET オブジェクトを拡張する機能を導入することで、この問題を解決します。</span><span class="sxs-lookup"><span data-stu-id="f3050-115">ETS resolves this issue by introducing the ability to extend the .NET object with additional members.</span></span>

<span data-ttu-id="f3050-116">2つ目の方法として、PowerShell スクリプト言語は、変数を特定の型で宣言する必要がないということ_ではあり_ません。</span><span class="sxs-lookup"><span data-stu-id="f3050-116">Second, the PowerShell scripting language is _typeless_ in that a variable does not need to be declared of a particular type.</span></span> <span data-ttu-id="f3050-117">つまり、スクリプト開発者が作成する変数は、本質的に_タイプレス_です。</span><span class="sxs-lookup"><span data-stu-id="f3050-117">That is, the variables a script developer creates are by nature _typeless_.</span></span> <span data-ttu-id="f3050-118">ただし、PowerShell システムは、結果の出力や並べ替えなどの基本的な操作のために、型名を使用することに依存しているので、"タイプドリブン" になります。</span><span class="sxs-lookup"><span data-stu-id="f3050-118">However, the PowerShell system is "type-driven" in that it depends on having a type name to operate against for basic operations such as outputting results or sorting.</span></span>

<span data-ttu-id="f3050-119">そのため、スクリプト開発者は、変数の1つの型を指定し、プロパティとメソッドを含む動的に型指定された "オブジェクト" のセットを構築し、型駆動型システムに参加させることができなければなりません。</span><span class="sxs-lookup"><span data-stu-id="f3050-119">Therefore a script developer must have the ability to state the type of one of their variables and build up their own set of dynamically typed "objects" that contain properties and methods and can participate in the type-driven system.</span></span> <span data-ttu-id="f3050-120">この問題を解決するには、その型を動的に指定し、メンバーを動的に追加することができるスクリプト言語の共通オブジェクトを提供します。</span><span class="sxs-lookup"><span data-stu-id="f3050-120">ETS solves this problem by providing a common object for the scripting language that has the ability to state its type dynamically and to add members dynamically.</span></span>

<span data-ttu-id="f3050-121">根本的には、前述の問題を解決します。 **PSObject**オブジェクトは、スクリプト言語からのすべてのオブジェクトアクセスの基礎として機能し、コマンドレットの開発者に標準の抽象化を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3050-121">Fundamentally, ETS resolves the issue mentioned previously by providing the **PSObject** object, which acts as the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span>

### <a name="cmdlet-developers"></a><span data-ttu-id="f3050-122">コマンドレットの開発者</span><span class="sxs-lookup"><span data-stu-id="f3050-122">Cmdlet Developers</span></span>

<span data-ttu-id="f3050-123">コマンドレットの開発者には、次のサポートが用意されています。</span><span class="sxs-lookup"><span data-stu-id="f3050-123">For the cmdlet developers, ETS provides the following support:</span></span>

- <span data-ttu-id="f3050-124">**PSObject**オブジェクトを使用して汎用的な方法でオブジェクトに対して動作する抽象化。</span><span class="sxs-lookup"><span data-stu-id="f3050-124">The abstractions to work against objects in a generic way using the **PSObject** object.</span></span> <span data-ttu-id="f3050-125">また、これらの抽象化を必要に応じてドリルダウンする機能も提供します。</span><span class="sxs-lookup"><span data-stu-id="f3050-125">ETS also provides the ability to drill past these abstractions if required.</span></span>
- <span data-ttu-id="f3050-126">よく知られている拡張メンバーのセットを使用して、オブジェクトの種類に対する書式設定、並べ替え、シリアル化、およびその他のシステム操作の既定の動作を作成するための機構。</span><span class="sxs-lookup"><span data-stu-id="f3050-126">The mechanisms to create a default behavior for formatting, sorting, serialization, and other system manipulations of their object type using a well-known set of extended members.</span></span>
- <span data-ttu-id="f3050-127">言語プリミティブオブジェクトを使用して、スクリプト言語と同じセマンティクスを使用して任意のオブジェクトに対して操作を実行することを意味します。</span><span class="sxs-lookup"><span data-stu-id="f3050-127">The means to operate against any object using the same semantics as the script language using a LanguagePrimitives object.</span></span>
- <span data-ttu-id="f3050-128">は、ハッシュテーブルを動的に "型" にすることを意味します。これにより、システムの残りの部分が効果的に操作できるようになります。</span><span class="sxs-lookup"><span data-stu-id="f3050-128">The means to dynamically "type" a hash table so that the rest of the system can operate against it effectively.</span></span>

### <a name="script-developers"></a><span data-ttu-id="f3050-129">スクリプト開発者</span><span class="sxs-lookup"><span data-stu-id="f3050-129">Script Developers</span></span>

<span data-ttu-id="f3050-130">スクリプト開発者には、次のサポートが用意されています。</span><span class="sxs-lookup"><span data-stu-id="f3050-130">For the script developers, ETS provides the following support:</span></span>

- <span data-ttu-id="f3050-131">同じ構文 () を使用して、基になるオブジェクト型を参照する機能 `$a.x` 。</span><span class="sxs-lookup"><span data-stu-id="f3050-131">The ability to reference any underlying object type using the same syntax (`$a.x`).</span></span>
- <span data-ttu-id="f3050-132">**PSObject**オブジェクトによって提供される抽象化の範囲を超えてアクセスする機能 (適用されるメンバーへのアクセス、ベースオブジェクト自体へのアクセスなど)。</span><span class="sxs-lookup"><span data-stu-id="f3050-132">The ability to access beyond the abstraction provided by the **PSObject** object (such as accessing only adapted members, or accessing the base object itself).</span></span>
- <span data-ttu-id="f3050-133">オブジェクトインスタンスまたは型の書式設定、並べ替え、シリアル化、およびその他の操作を制御する既知のメンバーを定義する機能。</span><span class="sxs-lookup"><span data-stu-id="f3050-133">The ability to define well-known members that control the formatting, sorting, serialization, and other manipulations of an object instance or type.</span></span>
- <span data-ttu-id="f3050-134">は、オブジェクトに特定の型として名前を付けて、その型ベースのメンバーの継承を制御することを意味します。</span><span class="sxs-lookup"><span data-stu-id="f3050-134">The means to name an object as a specific type and thus control the inheritance of its type-based members.</span></span>
- <span data-ttu-id="f3050-135">拡張メンバーを追加、削除、および変更する機能。</span><span class="sxs-lookup"><span data-stu-id="f3050-135">The ability to add, remove, and modify extended members.</span></span>
- <span data-ttu-id="f3050-136">必要に応じて、 **PSObject**オブジェクト自体を操作する権限。</span><span class="sxs-lookup"><span data-stu-id="f3050-136">The ability to manipulate the **PSObject** object itself if required.</span></span>

## <a name="the-psobject-class"></a><span data-ttu-id="f3050-137">PSObject クラス</span><span class="sxs-lookup"><span data-stu-id="f3050-137">The PSObject class</span></span>

<span data-ttu-id="f3050-138">**PSObject**オブジェクトは、スクリプト言語からのすべてのオブジェクトアクセスの基礎であり、コマンドレットの開発者を対象とした標準の抽象化を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3050-138">The **PSObject** object is the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span> <span data-ttu-id="f3050-139">これには、基本オブジェクト (.NET オブジェクト) と、特定のオブジェクトインスタンスに存在する (特に拡張メンバー) すべてのインスタンスメンバー (同じ型の他のオブジェクトではありません) が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f3050-139">It contains a base-object (a .NET object) and any instance members (members, specifically extended members, that are present on a particular object instance while not necessarily on other objects of the same type).</span></span> <span data-ttu-id="f3050-140">**PSObject**オブジェクトは、ベースオブジェクトの型によっては、適合したメンバーおよび任意の型ベースの拡張メンバーへの暗黙的かつ明示的なアクセスを提供する場合もあります。</span><span class="sxs-lookup"><span data-stu-id="f3050-140">Depending on the type of the base-object, the **PSObject** object might also provide implicit and explicit access to adapted members as well as any type-based extended members.</span></span>

<span data-ttu-id="f3050-141">**PSObject**オブジェクトには、次のメカニズムが用意されています。</span><span class="sxs-lookup"><span data-stu-id="f3050-141">The **PSObject** object provides the following mechanisms:</span></span>

- <span data-ttu-id="f3050-142">基底オブジェクトを使用するかどうかにかかわらず、 **PSObject**を構築する機能。</span><span class="sxs-lookup"><span data-stu-id="f3050-142">The ability to construct an **PSObject** with or without a base-object.</span></span>
- <span data-ttu-id="f3050-143">共通の参照アルゴリズムを使用して、構築された各**PSObject**オブジェクトのすべてのメンバーにアクセスする機能と、必要に応じてそのアルゴリズムをオーバーライドする機能。</span><span class="sxs-lookup"><span data-stu-id="f3050-143">The ability to access of all members of each constructed **PSObject** object through a common lookup algorithm and the ability to override that algorithm when required.</span></span>
- <span data-ttu-id="f3050-144">構築された**psobject**オブジェクトの型名を取得および設定する機能。これにより、スクリプトとコマンドレットは、基本オブジェクトの型に関係なく、同じ型名で類似した**psobject**オブジェクトを参照できます。</span><span class="sxs-lookup"><span data-stu-id="f3050-144">The ability to get and set the type-names of the constructed **PSObject** objects so that scripts and cmdlets can reference similar **PSObject** objects by the same type-name, regardless of the type of their base-object.</span></span>

### <a name="how-to-construct-a-psobject"></a><span data-ttu-id="f3050-145">PSObject を構築する方法</span><span class="sxs-lookup"><span data-stu-id="f3050-145">How to Construct a PSObject</span></span>

<span data-ttu-id="f3050-146">次の一覧では、 **PSObject**オブジェクトを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f3050-146">The following list describes ways to create a **PSObject** object:</span></span>

- <span data-ttu-id="f3050-147">**Psobject** #ctor コンストラクターを呼び出すと、PSCustomObject 基本オブジェクトを持つ新しい**PSObject**オブジェクトが作成されます。</span><span class="sxs-lookup"><span data-stu-id="f3050-147">Calling the **PSObject** .#ctor constructor creates a new **PSObject** object with a base-object of PSCustomObject.</span></span> <span data-ttu-id="f3050-148">この型の基本オブジェクトは、 **PSObject**オブジェクトに有効な基本オブジェクトがないことを示します。</span><span class="sxs-lookup"><span data-stu-id="f3050-148">A base-object of this type indicates that the **PSObject** object has no meaningful base-object.</span></span> <span data-ttu-id="f3050-149">ただし、この種類の base オブジェクトを持つ**PSObject**オブジェクトは、拡張メンバーを追加することによって、コマンドレットの開発者が役に立つプロパティバッグを提供します。</span><span class="sxs-lookup"><span data-stu-id="f3050-149">However, a **PSObject** object with this type of base-object does provide a property bag that cmdlet developers can find helpful by adding extended-members.</span></span>

<span data-ttu-id="f3050-150">開発者は、オブジェクトの種類名を指定することもできます。これにより、このオブジェクトが、その拡張メンバーを同じ型名の他の**PSObject**オブジェクトと共有できるようになります。</span><span class="sxs-lookup"><span data-stu-id="f3050-150">Developers can also specify the object type-name, which allows this object to share its extended-members with other **PSObject** objects of the same type-name.</span></span>

- <span data-ttu-id="f3050-151">#Ctor (System.object) コンストラクターを呼び出すと、System.object 型の基底オブジェクトを持つ新しい**PSObject**オブジェクトが作成**されます**。</span><span class="sxs-lookup"><span data-stu-id="f3050-151">Calling the **PSObject** .#ctor(System.Object) constructor creates a new **PSObject** object with a base-object of type System.Object.</span></span>

  <span data-ttu-id="f3050-152">この場合、作成されたオブジェクトの型名は、基本オブジェクトの派生階層のコレクションです。</span><span class="sxs-lookup"><span data-stu-id="f3050-152">In this case, the type-name for the created object is a collection of the derivation hierarchy of the base-object.</span></span> <span data-ttu-id="f3050-153">たとえば、ProcessInfo ベースオブジェクトを含む**PSObject**の型名には、次の名前が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f3050-153">For example, the type-name for the **PSObject** that contains a ProcessInfo base-object would include the following names:</span></span>

  - <span data-ttu-id="f3050-154">System.Diagnostics.Process</span><span class="sxs-lookup"><span data-stu-id="f3050-154">System.Diagnostics.Process</span></span>
  - <span data-ttu-id="f3050-155">System.componentmodel</span><span class="sxs-lookup"><span data-stu-id="f3050-155">System.ComponentModel.Component</span></span>
  - <span data-ttu-id="f3050-156">System.MarshalByRefObject</span><span class="sxs-lookup"><span data-stu-id="f3050-156">System.MarshalByRefObject</span></span>
  - <span data-ttu-id="f3050-157">System.Object</span><span class="sxs-lookup"><span data-stu-id="f3050-157">System.Object</span></span>

- <span data-ttu-id="f3050-158">**PSObject**を呼び出しています。AsPSObject (System.object) メソッドは、指定されたオブジェクトに基づいて新しい**PSObject**オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="f3050-158">Calling the **PSObject** .AsPSObject(System.Object) method creates a new **PSObject** object based on a supplied object.</span></span>

  <span data-ttu-id="f3050-159">指定されたオブジェクトが System.object 型である場合は、指定されたオブジェクトが新しい**PSObject**オブジェクトのベースオブジェクトとして使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3050-159">If the supplied object is of type System.Object, the supplied object is used as the base-object for the new **PSObject** object.</span></span> <span data-ttu-id="f3050-160">指定されたオブジェクトが既に**PSObject**オブジェクトである場合、指定されたオブジェクトはとして返されます。</span><span class="sxs-lookup"><span data-stu-id="f3050-160">If the supplied object is already an **PSObject** object, the supplied object is returned as is.</span></span>

### <a name="base-adapted-and-extended-members"></a><span data-ttu-id="f3050-161">基本メンバー、適合メンバー、および拡張メンバー</span><span class="sxs-lookup"><span data-stu-id="f3050-161">Base, adapted, and extended members</span></span>

<span data-ttu-id="f3050-162">概念的には、次の用語を使用して、ベースオブジェクトの元のメンバーと PowerShell によって追加されたメンバーの関係を示します。</span><span class="sxs-lookup"><span data-stu-id="f3050-162">Conceptually, ETS uses the following terms to show the relationship between the original members of the base-object and those members added by PowerShell.</span></span> <span data-ttu-id="f3050-163">**Psobject**オブジェクトによって使用される特定の種類のメンバーの詳細については、「 [psobject クラス](/dotnet/api/system.management.automation.psobject)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3050-163">For more information about the specific types of members that are used by the **PSObject** object, see [PSObject class](/dotnet/api/system.management.automation.psobject).</span></span>

#### <a name="base-object-members"></a><span data-ttu-id="f3050-164">基本オブジェクトのメンバー</span><span class="sxs-lookup"><span data-stu-id="f3050-164">Base-object members</span></span>

<span data-ttu-id="f3050-165">**PSObject**オブジェクトの構築時にベースオブジェクトが指定されている場合、基本オブジェクトのメンバーは、members プロパティを介して使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3050-165">If the base-object is specified when constructing the **PSObject** objects, then the members of the base-object are made available through the Members property.</span></span>

#### <a name="adapted-members"></a><span data-ttu-id="f3050-166">適合したメンバー</span><span class="sxs-lookup"><span data-stu-id="f3050-166">Adapted members</span></span>

<span data-ttu-id="f3050-167">基本オブジェクトがメタオブジェクトであり、その中に含まれるデータがプロパティによって "説明" されている汎用的な方法でデータを格納している場合は、を使用して、 **PSObject**オブジェクトの適用されたメンバーを介してデータに直接アクセスできるように、それらのオブジェクトをビューに適応させます。</span><span class="sxs-lookup"><span data-stu-id="f3050-167">When a base-object is a meta-object, one that contains data in a generic fashion whose properties "describe" their contained data, ETS adapts those objects to a view that allows for direct access to the data through adapted members of the **PSObject** object.</span></span> <span data-ttu-id="f3050-168">適合したメンバーと基本オブジェクトのメンバーにアクセスするには、Members プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="f3050-168">Adapted members and base-object members are accessed through the Members property.</span></span>

#### <a name="extended-members"></a><span data-ttu-id="f3050-169">拡張メンバー</span><span class="sxs-lookup"><span data-stu-id="f3050-169">Extended members</span></span>

<span data-ttu-id="f3050-170">ベースオブジェクトから使用できるメンバー、または PowerShell によって作成された適用されるメンバーに加えて、 **PSObject**は、スクリプト環境で役立つ追加情報を使用して元の基本オブジェクトを拡張する拡張メンバーを定義することもあります。</span><span class="sxs-lookup"><span data-stu-id="f3050-170">In addition to the members made available from the base-object or those adapted members created by PowerShell, an **PSObject** may also define extended members that extend the original base-object with additional information that is useful in the scripting environment.</span></span>

<span data-ttu-id="f3050-171">たとえば、Get Content および Set Content のコマンドレットなど、PowerShell で提供されるすべてのコアコマンドレットは、path パラメーターを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="f3050-171">For example, all the core cmdlets provided by PowerShell, such as the Get-Content and Set-Content cmdlets, take a path parameter.</span></span> <span data-ttu-id="f3050-172">これらのコマンドレットおよび他のコマンドレットが異なる種類のオブジェクトに対して動作できるようにするには、それらのオブジェクトにパスメンバーを追加して、それらのすべてが共通の方法で情報を参照できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f3050-172">To ensure that these cmdlets, and others, can work against objects of different types, a Path member can be added to those objects so that they all state their information in a common way.</span></span> <span data-ttu-id="f3050-173">この拡張パスメンバーを使用すると、基底クラスにパスメンバーが含まれていない場合でも、これらのすべての型に対してコマンドレットを確実に動作させることができます。</span><span class="sxs-lookup"><span data-stu-id="f3050-173">This extended Path member ensures that the cmdlets can work against all those types even though there base class might not have a Path member.</span></span>

<span data-ttu-id="f3050-174">拡張メンバー、適用されるメンバー、および基本オブジェクトのメンバーはすべて、Members プロパティを介してアクセスされます。</span><span class="sxs-lookup"><span data-stu-id="f3050-174">Extended members, adapted members, and base-object members are all accessed through the Members property.</span></span>
