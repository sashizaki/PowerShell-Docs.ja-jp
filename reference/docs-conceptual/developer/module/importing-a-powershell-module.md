---
ms.date: 02/03/2020
ms.topic: reference
title: PowerShell モジュールをインポートする
description: PowerShell モジュールをインポートする
ms.openlocfilehash: 688509c0943a9a0289e75b80543f278e16cfedfe
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2020
ms.locfileid: "92658779"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="e867a-103">PowerShell モジュールをインポートする</span><span class="sxs-lookup"><span data-stu-id="e867a-103">Importing a PowerShell Module</span></span>

<span data-ttu-id="e867a-104">システムにモジュールをインストールしたら、モジュールをインポートすることができます。</span><span class="sxs-lookup"><span data-stu-id="e867a-104">Once you have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="e867a-105">インポートとは、ユーザーが PowerShell セッションでそのモジュールにアクセスできるように、モジュールをアクティブメモリに読み込むプロセスです。</span><span class="sxs-lookup"><span data-stu-id="e867a-105">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="e867a-106">PowerShell 2.0 では、新しくインストールされた PowerShell モジュールを import [-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) コマンドレットの呼び出しを使用してインポートできます。</span><span class="sxs-lookup"><span data-stu-id="e867a-106">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="e867a-107">PowerShell 3.0 では、モジュール内の関数またはコマンドレットのいずれかがユーザーによって呼び出されたときに、PowerShell は暗黙的にモジュールをインポートできます。</span><span class="sxs-lookup"><span data-stu-id="e867a-107">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="e867a-108">どちらのバージョンも、PowerShell が検出できる場所にモジュールをインストールすることを前提としています。詳細については、「 [PowerShell モジュールのインストール](./installing-a-powershell-module.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e867a-108">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span>
<span data-ttu-id="e867a-109">モジュールマニフェストを使用して、モジュールのどの部分をエクスポートするかを制限できます。また、呼び出しのパラメーターを使用して、 `Import-Module` インポートする部分を制限できます。</span><span class="sxs-lookup"><span data-stu-id="e867a-109">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="e867a-110">Snap-In のインポート (PowerShell 1.0)</span><span class="sxs-lookup"><span data-stu-id="e867a-110">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="e867a-111">モジュールが PowerShell 1.0 に存在しませんでした。代わりに、スナップインを登録して使用する必要がありました。ただし、モジュールをインストールしてインポートする方が一般的であるため、このテクノロジはこの時点では使用しないことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="e867a-111">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="e867a-112">詳細については、「 [Windows PowerShell スナップインを作成する方法](../cmdlet/how-to-create-a-windows-powershell-snap-in.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e867a-112">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="e867a-113">Import-Module を使用したモジュールのインポート (PowerShell 2.0)</span><span class="sxs-lookup"><span data-stu-id="e867a-113">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="e867a-114">PowerShell 2.0 では、適切に指定された [インポートモジュール](/powershell/module/Microsoft.PowerShell.Core/Import-Module) コマンドレットを使用してモジュールをインポートします。</span><span class="sxs-lookup"><span data-stu-id="e867a-114">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="e867a-115">このコマンドレットを実行すると、Windows PowerShell は、変数で指定されたディレクトリ内で指定されたモジュールを検索し `PSModulePath` ます。</span><span class="sxs-lookup"><span data-stu-id="e867a-115">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="e867a-116">指定されたディレクトリが見つかった場合、Windows PowerShell は、モジュールマニフェストファイル (.psd1)、スクリプトモジュールファイル (hbase-runner.psm1)、バイナリモジュールファイル (.dll) の順にファイルを検索します。</span><span class="sxs-lookup"><span data-stu-id="e867a-116">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="e867a-117">検索にディレクトリを追加する方法の詳細については、「 [PSModulePath のインストールパスの変更](./modifying-the-psmodulepath-installation-path.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e867a-117">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span>
<span data-ttu-id="e867a-118">次のコードは、モジュールをインポートする方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="e867a-118">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="e867a-119">MyModule がに配置されていると仮定すると `PSModulePath` 、PowerShell は myModule をアクティブなメモリに読み込みます。</span><span class="sxs-lookup"><span data-stu-id="e867a-119">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="e867a-120">MyModule がパスに配置されていない場合 `PSModulePath` でも、それを見つける場所を PowerShell に明示的に指示できます。</span><span class="sxs-lookup"><span data-stu-id="e867a-120">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="e867a-121">パラメーターを使用して、 `-Verbose` モジュールからエクスポートされる内容と、アクティブなメモリにインポートされる内容を識別することもできます。</span><span class="sxs-lookup"><span data-stu-id="e867a-121">You can also use the `-Verbose` parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="e867a-122">エクスポートとインポートはどちらも、ユーザーに公開されるものを制限します。違いは、表示を制御しているユーザーです。</span><span class="sxs-lookup"><span data-stu-id="e867a-122">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="e867a-123">基本的に、エクスポートはモジュール内のコードによって制御されます。</span><span class="sxs-lookup"><span data-stu-id="e867a-123">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="e867a-124">これに対し、インポートは呼び出しによって制御され `Import-Module` ます。</span><span class="sxs-lookup"><span data-stu-id="e867a-124">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="e867a-125">詳細については、以下の「 **インポートされるメンバーの制限**」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e867a-125">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="e867a-126">モジュールを暗黙的にインポートする (PowerShell 3.0)</span><span class="sxs-lookup"><span data-stu-id="e867a-126">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="e867a-127">Windows PowerShell 3.0 以降、モジュールのコマンドレットまたは関数をコマンドで使用すると、モジュールは自動的にインポートされます。</span><span class="sxs-lookup"><span data-stu-id="e867a-127">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="e867a-128">この機能は、 **PSModulePath** 環境変数の値に含まれているディレクトリ内の任意のモジュールに対して機能します。</span><span class="sxs-lookup"><span data-stu-id="e867a-128">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="e867a-129">ただし、モジュールを有効なパスに保存しない場合でも、上記の明示的な [モジュール](/powershell/module/Microsoft.PowerShell.Core/Import-Module) を使用して読み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="e867a-129">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="e867a-130">次のアクションを実行すると、モジュールの自動インポートがトリガーされます ("モジュールの自動読み込み" とも呼ばれます)。</span><span class="sxs-lookup"><span data-stu-id="e867a-130">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="e867a-131">コマンドでコマンドレットを使用します。</span><span class="sxs-lookup"><span data-stu-id="e867a-131">Using a cmdlet in a command.</span></span> <span data-ttu-id="e867a-132">たとえば、「」と入力すると、 `Get-ExecutionPolicy` コマンドレットを含む、Microsoft. PowerShell. Security モジュールがインポートされます。 `Get-ExecutionPolicy`</span><span class="sxs-lookup"><span data-stu-id="e867a-132">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="e867a-133">コマンドを取得する [には、コマンドレットを](/powershell/module/Microsoft.PowerShell.Core/Get-Command) 使用します。</span><span class="sxs-lookup"><span data-stu-id="e867a-133">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span> <span data-ttu-id="e867a-134">たとえば、「」と入力すると、 `Get-Command Get-JobTrigger` コマンドレットを含む **Psscheduledjob** モジュールがインポートされ `Get-JobTrigger` ます。</span><span class="sxs-lookup"><span data-stu-id="e867a-134">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="e867a-135">`Get-Command`ワイルドカード文字を含むコマンドは検出と見なされ、モジュールのインポートはトリガーされません。</span><span class="sxs-lookup"><span data-stu-id="e867a-135">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="e867a-136">コマンドレットのヘルプを取得するには、 [get-help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) コマンドレットを使用します。</span><span class="sxs-lookup"><span data-stu-id="e867a-136">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="e867a-137">たとえば、「」と入力すると、 `Get-Help Get-WinEvent` コマンドレットを含む、Microsoft. PowerShell 診断モジュールがインポートされます。 `Get-WinEvent`</span><span class="sxs-lookup"><span data-stu-id="e867a-137">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="e867a-138">モジュールの自動インポートをサポートするために、この `Get-Command` コマンドレットは、モジュールがセッションにインポートされていない場合でも、インストールされているすべてのモジュールのすべてのコマンドレットと関数を取得します。</span><span class="sxs-lookup"><span data-stu-id="e867a-138">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="e867a-139">詳細については、 [コマンド](/powershell/module/Microsoft.PowerShell.Core/Get-Command) レットのヘルプトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="e867a-139">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="e867a-140">インポート処理</span><span class="sxs-lookup"><span data-stu-id="e867a-140">The Importing Process</span></span>

<span data-ttu-id="e867a-141">モジュールがインポートされると、モジュールの新しいセッション状態が作成され、 [PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) オブジェクトがメモリ内に作成されます。</span><span class="sxs-lookup"><span data-stu-id="e867a-141">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="e867a-142">インポートされたモジュールごとにセッション状態が作成されます (これには、ルートモジュールと入れ子になったモジュールが含まれます)。</span><span class="sxs-lookup"><span data-stu-id="e867a-142">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="e867a-143">ルートモジュールからエクスポートされたメンバー (入れ子になったモジュールによってルートモジュールにエクスポートされたメンバーも含む) は、呼び出し元のセッション状態にインポートされます。</span><span class="sxs-lookup"><span data-stu-id="e867a-143">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="e867a-144">モジュールからエクスポートされたメンバーのメタデータには、ModuleName プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="e867a-144">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="e867a-145">このプロパティには、エクスポートしたモジュールの名前が設定されます。</span><span class="sxs-lookup"><span data-stu-id="e867a-145">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="e867a-146">エクスポートされたメンバーの名前が未承認の動詞を使用する場合、またはメンバーの名前が制限付きの文字を使用する場合は、 [モジュールのインポート](/powershell/module/Microsoft.PowerShell.Core/Import-Module) コマンドレットの実行時に警告が表示されます。</span><span class="sxs-lookup"><span data-stu-id="e867a-146">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="e867a-147">既定では、 [モジュールのインポート](/powershell/module/Microsoft.PowerShell.Core/Import-Module) コマンドレットは、パイプラインにオブジェクトを返しません。</span><span class="sxs-lookup"><span data-stu-id="e867a-147">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="e867a-148">ただし、このコマンドレットでは、インポートされるモジュールごとに [PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo)オブジェクトを返すために使用できる **PassThru** パラメーターがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="e867a-148">However, the cmdlet supports a **PassThru** parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="e867a-149">出力をホストに送信するには、ユーザーが [書き込みホスト](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) コマンドレットを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e867a-149">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="e867a-150">インポートされるメンバーの制限</span><span class="sxs-lookup"><span data-stu-id="e867a-150">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="e867a-151">モジュールを [インポートモジュール](/powershell/module/Microsoft.PowerShell.Core/Import-Module) のコマンドレットを使用してインポートすると、既定では、エクスポートされたすべてのモジュールメンバーがセッションにインポートされます。これには、入れ子になったモジュールによってモジュールにエクスポートされたコマンドも含まれます。</span><span class="sxs-lookup"><span data-stu-id="e867a-151">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="e867a-152">既定では、変数および別名はエクスポートされません。</span><span class="sxs-lookup"><span data-stu-id="e867a-152">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="e867a-153">エクスポートされるメンバーを制限するには、 [モジュールマニフェスト](./how-to-write-a-powershell-module-manifest.md)を使用します。</span><span class="sxs-lookup"><span data-stu-id="e867a-153">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span>
<span data-ttu-id="e867a-154">インポートされるメンバーを制限するには、コマンドレットの次のパラメーターを使用し `Import-Module` ます。</span><span class="sxs-lookup"><span data-stu-id="e867a-154">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="e867a-155">**関数**: このパラメーターは、エクスポートされる関数を制限します。</span><span class="sxs-lookup"><span data-stu-id="e867a-155">**Function**: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="e867a-156">(モジュールマニフェストを使用している場合は、FunctionsToExport キーを参照してください)。</span><span class="sxs-lookup"><span data-stu-id="e867a-156">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="e867a-157">\`**コマンドレット**: このパラメーターは、エクスポートされるコマンドレットを制限します (モジュールマニフェストを使用している場合は、コマンドレット stoexport キーを参照してください)。</span><span class="sxs-lookup"><span data-stu-id="e867a-157">\`**Cmdlet**: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="e867a-158">**Variable**: このパラメーターは、エクスポートされる変数を制限します (モジュールマニフェストを使用している場合は、Variables stoexport キーを参照してください)。</span><span class="sxs-lookup"><span data-stu-id="e867a-158">**Variable**: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="e867a-159">**エイリアス**: このパラメーターでは、エクスポートされるエイリアスを制限します (モジュールマニフェストを使用している場合は、「Are Asestoexport キー」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="e867a-159">**Alias**: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="e867a-160">参照</span><span class="sxs-lookup"><span data-stu-id="e867a-160">See Also</span></span>

[<span data-ttu-id="e867a-161">Windows PowerShell モジュールを記述する</span><span class="sxs-lookup"><span data-stu-id="e867a-161">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
