---
ms.date: 09/13/2016
ms.topic: reference
title: Windows PowerShell アイテム プロバイダーを作成する
description: Windows PowerShell アイテム プロバイダーを作成する
ms.openlocfilehash: f98ea90bf9ce7222076a91fb26dc42977c70bff2
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2020
ms.locfileid: "92645182"
---
# <a name="creating-a-windows-powershell-item-provider"></a><span data-ttu-id="82ec0-103">Windows PowerShell アイテム プロバイダーを作成する</span><span class="sxs-lookup"><span data-stu-id="82ec0-103">Creating a Windows PowerShell Item Provider</span></span>

<span data-ttu-id="82ec0-104">このトピックでは、データストア内のデータを操作できる Windows PowerShell プロバイダーを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-104">This topic describes how to create a Windows PowerShell provider that can manipulate the data in a data store.</span></span> <span data-ttu-id="82ec0-105">このトピックでは、ストア内のデータの要素を、データストアの "項目" と呼びます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-105">In this topic, the elements of data in the store are referred to as the "items" of the data store.</span></span> <span data-ttu-id="82ec0-106">その結果、ストア内のデータを操作できるプロバイダーは、Windows PowerShell 項目プロバイダーと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-106">As a consequence, a provider that can manipulate the data in the store is referred to as a Windows PowerShell item provider.</span></span>

> [!NOTE]
> <span data-ttu-id="82ec0-107">このプロバイダーの C# ソースファイル (AccessDBSampleProvider03.cs) は、Windows Vista および .NET Framework 3.0 ランタイムコンポーネントの Microsoft Windows Software Development Kit を使用してダウンロードできます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-107">You can download the C# source file (AccessDBSampleProvider03.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="82ec0-108">ダウンロードの手順については、「 [Windows powershell をインストールする方法」および「Windows POWERSHELL SDK をダウンロードする方法](/powershell/scripting/developer/installing-the-windows-powershell-sdk)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-108">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="82ec0-109">ダウンロードしたソースファイルは、ディレクトリにあり **\<PowerShell Samples>** ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-109">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="82ec0-110">その他の Windows PowerShell プロバイダーの実装の詳細については、「 [Windows Powershell プロバイダーの設計](./designing-your-windows-powershell-provider.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-110">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="82ec0-111">このトピックで説明する Windows PowerShell 項目プロバイダーは、Access データベースからデータの項目を取得します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-111">The Windows PowerShell item provider described in this topic gets items of data from an Access database.</span></span> <span data-ttu-id="82ec0-112">この場合、"item" は Access データベースのテーブルまたはテーブル内の行のいずれかです。</span><span class="sxs-lookup"><span data-stu-id="82ec0-112">In this case, an "item" is either a table in the Access database or a row in a table.</span></span>

## <a name="defining-the-windows-powershell-item-provider-class"></a><span data-ttu-id="82ec0-113">Windows PowerShell 項目プロバイダークラスの定義</span><span class="sxs-lookup"><span data-stu-id="82ec0-113">Defining the Windows PowerShell Item Provider Class</span></span>

<span data-ttu-id="82ec0-114">Windows PowerShell 項目プロバイダーでは、.NET クラスを定義する必要があります。このクラス [の基底クラス](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) から派生します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-114">A Windows PowerShell item provider must define a .NET class that derives from the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="82ec0-115">このセクションで説明する項目プロバイダーのクラス定義を次に示します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-115">The following is the class definition for the item provider described in this section.</span></span>

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs" range="34-36":::

<span data-ttu-id="82ec0-116">このクラス定義では、 [system.string 属性に2つのパラメーター](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) が含まれていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-116">Note that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="82ec0-117">最初のパラメーターは、Windows PowerShell によって使用されるプロバイダーのわかりやすい名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-117">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="82ec0-118">2番目のパラメーターは、コマンドの処理中にプロバイダーが Windows PowerShell ランタイムに公開する Windows PowerShell 固有の機能を指定します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-118">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="82ec0-119">このプロバイダーには、Windows PowerShell 固有の機能は追加されていません。</span><span class="sxs-lookup"><span data-stu-id="82ec0-119">For this provider, there are no added Windows PowerShell specific capabilities.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="82ec0-120">基本機能の定義</span><span class="sxs-lookup"><span data-stu-id="82ec0-120">Defining Base Functionality</span></span>

<span data-ttu-id="82ec0-121">「 [Windows PowerShell プロバイダーの設計](./designing-your-windows-powershell-provider.md)」で説明されているように、 [Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) クラスは、さまざまなプロバイダー機能を提供する他のいくつかのクラスから派生します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-121">As described in [Design Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="82ec0-122">そのため、Windows PowerShell 項目プロバイダーは、これらのクラスによって提供されるすべての機能を定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-122">A Windows PowerShell item provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="82ec0-123">セッション固有の初期化情報を追加したり、プロバイダーで使用されるリソースを解放したりするための機能を実装する方法の詳細については、「 [基本的な Windows PowerShell プロバイダーの作成](./creating-a-basic-windows-powershell-provider.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-123">For more information about how to implement functionality for adding session-specific initialization information and for releasing resources used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span>
<span data-ttu-id="82ec0-124">ただし、ここで説明するプロバイダーを含むほとんどのプロバイダーは、Windows PowerShell によって提供されるこの機能の既定の実装を使用できます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-124">However, most providers, including the provider described here, can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="82ec0-125">Windows PowerShell 項目プロバイダーがストア内の項目を操作できるようにするには、データストアにアクセスするために、 [Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) 基底クラスのメソッドを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-125">Before the Windows PowerShell item provider can manipulate the items in the store, it must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class to access to the data store.</span></span> <span data-ttu-id="82ec0-126">このクラスの実装の詳細については、「 [Windows PowerShell ドライブプロバイダーの作成](./creating-a-windows-powershell-drive-provider.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-126">For more information about implementing this class, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="checking-for-path-validity"></a><span data-ttu-id="82ec0-127">パスの有効性を確認しています</span><span class="sxs-lookup"><span data-stu-id="82ec0-127">Checking for Path Validity</span></span>

<span data-ttu-id="82ec0-128">Windows powershell ランタイムは、データの項目を検索するときに、windows powershell の [動作につい](/previous-versions/ms714658(v=vs.85))ての「Pspath の概念」セクションで定義されているように、プロバイダーへの windows powershell パスを提供します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-128">When looking for an item of data, the Windows PowerShell runtime furnishes a Windows PowerShell path to the provider, as defined in the "PSPath Concepts" section of [How Windows PowerShell Works](/previous-versions/ms714658(v=vs.85)).</span></span>
<span data-ttu-id="82ec0-129">Windows PowerShell 項目プロバイダーは、指定されたパスの構文とセマンティックの有効性を検証する必要があります。そのためには、 [System.](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) .................. を実装します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-129">An Windows PowerShell item provider must verify the syntactic and semantic validity of any path passed to it by implementing the [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) method.</span></span> <span data-ttu-id="82ec0-130">`true`パスが有効な場合、このメソッドはを返し `false` ます。それ以外の場合はを返します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-130">This method returns `true` if the path is valid, and `false` otherwise.</span></span> <span data-ttu-id="82ec0-131">このメソッドの実装では、パスに項目が存在するかどうかを検証しないことに注意してください。ただし、パスの構文的で意味が正しいことだけを確認してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-131">Be aware that the implementation of this method should not verify the existence of the item at the path, but only that the path is syntactically and semantically correct.</span></span>

<span data-ttu-id="82ec0-132">ここでは、このプロバイダーのシステムの管理を実装しています。このプロバイダーの [Isvalidpath \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) メソッド。</span><span class="sxs-lookup"><span data-stu-id="82ec0-132">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) method for this provider.</span></span> <span data-ttu-id="82ec0-133">この実装では、NormalizePath ヘルパーメソッドを呼び出して、パス内のすべての区切り記号を一様なものに変換することに注意してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-133">Note that this implementation calls a NormalizePath helper method to convert all separators in the path to a uniform one.</span></span>

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs" range="274-298":::

## <a name="determining-if-an-item-exists"></a><span data-ttu-id="82ec0-134">項目が存在するかどうかを判断する</span><span class="sxs-lookup"><span data-stu-id="82ec0-134">Determining if an Item Exists</span></span>

<span data-ttu-id="82ec0-135">パスを確認した後、Windows PowerShell ランタイムは、データの項目がそのパスに存在するかどうかを判断する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-135">After verifying the path, the Windows PowerShell runtime must determine if an item of data exists at that path.</span></span> <span data-ttu-id="82ec0-136">この種類のクエリをサポートするために、Windows PowerShell 項目プロバイダーは、 [システムの管理](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) を実装しています。</span><span class="sxs-lookup"><span data-stu-id="82ec0-136">To support this type of query, the Windows PowerShell item provider implements the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method.</span></span> <span data-ttu-id="82ec0-137">このメソッド `true` は、指定されたパスで見つかった項目を返し `false` ます (既定値)。それ以外の場合は。</span><span class="sxs-lookup"><span data-stu-id="82ec0-137">This method returns `true` an item is found at the specified path and `false` (default) otherwise.</span></span>

<span data-ttu-id="82ec0-138">次に示すのは、このプロバイダーの system.servicemodel.................... [Itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) メソッドの実装です。</span><span class="sxs-lookup"><span data-stu-id="82ec0-138">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method for this provider.</span></span> <span data-ttu-id="82ec0-139">このメソッドは PathIsDrive、ChunkPath、および GetTable helper メソッドを呼び出し、プロバイダーによって定義されたオブジェクトを使用します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-139">Note that this method calls the PathIsDrive, ChunkPath, and GetTable helper methods, and uses a provider defined DatabaseTableInfo object.</span></span>

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs" range="229-267":::

#### <a name="things-to-remember-about-implementing-itemexists"></a><span data-ttu-id="82ec0-140">ItemExists の実装に関する注意事項</span><span class="sxs-lookup"><span data-stu-id="82ec0-140">Things to Remember About Implementing ItemExists</span></span>

<span data-ttu-id="82ec0-141">次の条件は、システムの実装に適用される場合があります。 [Itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists):</span><span class="sxs-lookup"><span data-stu-id="82ec0-141">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists):</span></span>

- <span data-ttu-id="82ec0-142">プロバイダークラスを定義すると、Windows PowerShell 項目プロバイダーは、ExpandWildcards カード、フィルター、包含、または除外のプロバイダー機能を、 [システム](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) の列挙体から宣言できます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-142">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="82ec0-143">このような場合、 [システム](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) の実装では、メソッドに渡されるパスが指定された機能の要件を満たしていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-143">In these cases, the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="82ec0-144">これを行うには、メソッドが適切なプロパティにアクセスする必要があります。たとえば、 ["..](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .............................................. [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) ...</span><span class="sxs-lookup"><span data-stu-id="82ec0-144">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="82ec0-145">このメソッドの実装では、項目がユーザーに表示される可能性のある項目への任意の形式のアクセスを処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-145">The implementation of this method should handle any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="82ec0-146">たとえば、ユーザーがファイルシステムプロバイダー (Windows PowerShell によって提供される) を介してファイルに対する書き込みアクセス権を持っていても、 [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists)読み取りアクセス権を持っていない場合、ファイルはまだ存在しています`true`。</span><span class="sxs-lookup"><span data-stu-id="82ec0-146">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="82ec0-147">子項目を列挙できるかどうかを確認するために、の実装で親項目を確認することが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-147">Your implementation might require checking a parent item to see if the child item can be enumerated.</span></span>

## <a name="attaching-dynamic-parameters-to-the-test-path-cmdlet"></a><span data-ttu-id="82ec0-148">Test-Path コマンドレットへの動的パラメーターのアタッチ</span><span class="sxs-lookup"><span data-stu-id="82ec0-148">Attaching Dynamic Parameters to the Test-Path Cmdlet</span></span>

<span data-ttu-id="82ec0-149">場合によっては、コマンドレットには、 `Test-Path` 実行時に動的に指定される追加のパラメーターが必要です[。](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists)</span><span class="sxs-lookup"><span data-stu-id="82ec0-149">Sometimes the `Test-Path` cmdlet that calls [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="82ec0-150">これらの動的パラメーターを指定するには、Windows PowerShell 項目プロバイダーで、system.servicemodel.............................- [Dynamicsdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExistsDynamicParameters) メソッドを実装します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-150">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexistsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExistsDynamicParameters) method.</span></span> <span data-ttu-id="82ec0-151">このメソッドは、指定されたパスにある項目の動的パラメーターを取得し、コマンドレットクラスまたは system.servicemodel 型の Parameterdictionary と同様に解析属性を持つプロパティとフィールドを持つオブジェクトを返します。 [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="82ec0-151">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="82ec0-152">Windows PowerShell ランタイムは、返されたオブジェクトを使用して、コマンドレットにパラメーターを追加し `Test-Path` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-152">The Windows PowerShell runtime uses the returned object to add the parameters to the `Test-Path` cmdlet.</span></span>

<span data-ttu-id="82ec0-153">この Windows PowerShell 項目プロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="82ec0-153">This Windows PowerShell item provider does not implement this method.</span></span> <span data-ttu-id="82ec0-154">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="82ec0-154">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovideritemexistdynamicparameters](Msh_samplestestcmdlets#testprovideritemexistdynamicparameters)]  -->

## <a name="retrieving-an-item"></a><span data-ttu-id="82ec0-155">項目を取得する</span><span class="sxs-lookup"><span data-stu-id="82ec0-155">Retrieving an Item</span></span>

<span data-ttu-id="82ec0-156">項目を取得するには、Windows PowerShell 項目プロバイダーが、コマンドレットからの呼び出しをサポートするように、system.string [\* Getitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) メソッドをオーバーライドする必要があり `Get-Item` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-156">To retrieve an item, the Windows PowerShell item provider must override [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method to support calls from the `Get-Item` cmdlet.</span></span> <span data-ttu-id="82ec0-157">このメソッドは、 [システム](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) の.............................. を使用して項目を書き込みます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-157">This method writes the item using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method.</span></span>

<span data-ttu-id="82ec0-158">次に示すのは、このプロバイダーに対する system.servicemodel......................... [...](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) を実装したものです。</span><span class="sxs-lookup"><span data-stu-id="82ec0-158">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for this provider.</span></span> <span data-ttu-id="82ec0-159">このメソッドは、GetTable と GetRow のヘルパーメソッドを使用して、Access データベース内のテーブルまたはデータテーブル内の行のいずれかの項目を取得します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-159">Note that this method uses the GetTable and GetRow helper methods to retrieve items that are either tables in the Access database or rows in a data table.</span></span>

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs" range="132-163":::

#### <a name="things-to-remember-about-implementing-getitem"></a><span data-ttu-id="82ec0-160">GetItem の実装に関する注意事項</span><span class="sxs-lookup"><span data-stu-id="82ec0-160">Things to Remember About Implementing GetItem</span></span>

<span data-ttu-id="82ec0-161">次の条件は、 [システム](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem)の実装に適用される可能性があります。...</span><span class="sxs-lookup"><span data-stu-id="82ec0-161">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem):</span></span>

- <span data-ttu-id="82ec0-162">プロバイダークラスを定義すると、Windows PowerShell 項目プロバイダーは、ExpandWildcards カード、フィルター、包含、または除外のプロバイダー機能を、 [システム](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) の列挙体から宣言できます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-162">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="82ec0-163">このような場合は、メソッドに渡されるパスが要件を満たしているかどうかを確認する必要[があります。](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem)</span><span class="sxs-lookup"><span data-stu-id="82ec0-163">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="82ec0-164">これを行うには、メソッドが適切なプロパティにアクセスする必要があります。たとえば、 ["..](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .............................................. [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) ...</span><span class="sxs-lookup"><span data-stu-id="82ec0-164">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="82ec0-165">既定では、このメソッドをオーバーライドしても、通常はユーザーに表示されないオブジェクトを取得しないでください。この場合、 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) プロパティがに設定されている必要があり `true` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-165">By default, overrides of this method should not retrieve objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="82ec0-166">たとえば、FileSystem プロバイダーの場合は、system [.](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) ................................................... [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) ... [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) .......。</span><span class="sxs-lookup"><span data-stu-id="82ec0-166">For example, the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the FileSystem provider checks the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property before it attempts to call [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) for hidden or system files.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-item-cmdlet"></a><span data-ttu-id="82ec0-167">Get-Item コマンドレットへの動的パラメーターのアタッチ</span><span class="sxs-lookup"><span data-stu-id="82ec0-167">Attaching Dynamic Parameters to the Get-Item Cmdlet</span></span>

<span data-ttu-id="82ec0-168">コマンドレットには、 `Get-Item` 実行時に動的に指定される追加のパラメーターが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-168">Sometimes the `Get-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="82ec0-169">これらの動的パラメーターを指定するには、Windows PowerShell 項目プロバイダーで [Getitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItemDynamicParameters) メソッドを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-169">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Getitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItemDynamicParameters) method.</span></span> <span data-ttu-id="82ec0-170">このメソッドは、指定されたパスにある項目の動的パラメーターを取得し、コマンドレットクラスまたは system.servicemodel 型の Parameterdictionary と同様に解析属性を持つプロパティとフィールドを持つオブジェクトを返します。 [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="82ec0-170">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="82ec0-171">Windows PowerShell ランタイムは、返されたオブジェクトを使用して、コマンドレットにパラメーターを追加し `Get-Item` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-171">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-Item` cmdlet.</span></span>

<span data-ttu-id="82ec0-172">このプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="82ec0-172">This provider does not implement this method.</span></span> <span data-ttu-id="82ec0-173">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="82ec0-173">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetitemdynamicparameters](Msh_samplestestcmdlets#testprovidergetitemdynamicparameters)]  -->

## <a name="setting-an-item"></a><span data-ttu-id="82ec0-174">項目を設定する</span><span class="sxs-lookup"><span data-stu-id="82ec0-174">Setting an Item</span></span>

<span data-ttu-id="82ec0-175">項目を設定するには、Windows PowerShell 項目プロバイダーで[Setitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem)メソッドをオーバーライドして、コマンドレットからの呼び出しをサポートする必要があります。 `Set-Item`</span><span class="sxs-lookup"><span data-stu-id="82ec0-175">To set an item, the Windows PowerShell item provider must override the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method to support calls from the `Set-Item` cmdlet.</span></span> <span data-ttu-id="82ec0-176">このメソッドは、指定されたパスにある項目の値を設定します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-176">This method sets the value of the item at the specified path.</span></span>

<span data-ttu-id="82ec0-177">このプロバイダーでは、  [Setitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) メソッドのオーバーライドは提供されていませんが、</span><span class="sxs-lookup"><span data-stu-id="82ec0-177">This provider does not provide an override for the  [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method.</span></span> <span data-ttu-id="82ec0-178">ただし、このメソッドの既定の実装は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="82ec0-178">However, the following is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidersetitem](Msh_samplestestcmdlets#testprovidersetitem)]  -->

#### <a name="things-to-remember-about-implementing-setitem"></a><span data-ttu-id="82ec0-179">SetItem の実装に関する注意事項</span><span class="sxs-lookup"><span data-stu-id="82ec0-179">Things to Remember About Implementing SetItem</span></span>

<span data-ttu-id="82ec0-180">[Setitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem)の実装には、次の条件が当てはまる場合があります:。</span><span class="sxs-lookup"><span data-stu-id="82ec0-180">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem):</span></span>

- <span data-ttu-id="82ec0-181">プロバイダークラスを定義すると、Windows PowerShell 項目プロバイダーは、ExpandWildcards カード、フィルター、包含、または除外のプロバイダー機能を、 [システム](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) の列挙体から宣言できます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-181">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="82ec0-182">このような場合は、 [Setitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) の実装によって、メソッドに渡されるパスが要件を満たしていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-182">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="82ec0-183">これを行うには、メソッドが適切なプロパティにアクセスする必要があります。たとえば、 ["..](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .............................................. [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) ...</span><span class="sxs-lookup"><span data-stu-id="82ec0-183">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="82ec0-184">既定では、このメソッドのオーバーライドでは、ユーザーに表示されないオブジェクトを設定または作成することはできません。この場合、 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) プロパティがに設定されている必要があり `true` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-184">By default, overrides of this method should not set or write objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="82ec0-185">パスが非表示の項目と [WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) \* を表している場合は、このメソッドにエラーを送信する必要があります。 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) は、に設定されてい `false` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-185">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents a hidden item and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="82ec0-186">[Setitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem)メソッドを実装するには、システムを呼び出す必要があり[ます。](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)その場合は、データストアに変更を加える前に、その戻り値を確認してから、その戻り値を確認してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-186">Your implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="82ec0-187">このメソッドは、ファイルの削除など、データストアに変更が加えられたときの操作の実行を確認するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-187">This method is used to confirm execution of an operation when a change is made to the data store, for example, deleting files.</span></span> <span data-ttu-id="82ec0-188">" [System.](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) .......................................................................</span><span class="sxs-lookup"><span data-stu-id="82ec0-188">The [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="82ec0-189">Setitem を呼び出すと、[が返され](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)ます。このメソッドは、system........................ を呼び出す `true` 必要があり[](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) [](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-189">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="82ec0-190">このメソッドは、ユーザーにメッセージを送信して、操作を続行する必要があるかどうかを確認するフィードバックを許可します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-190">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="82ec0-191">System.object を呼び出すと、危険性の高いシステム変更を追加で確認できるように[なります。](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)</span><span class="sxs-lookup"><span data-stu-id="82ec0-191">The call to [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="retrieving-dynamic-parameters-for-setitem"></a><span data-ttu-id="82ec0-192">SetItem の動的パラメーターの取得</span><span class="sxs-lookup"><span data-stu-id="82ec0-192">Retrieving Dynamic Parameters for SetItem</span></span>

<span data-ttu-id="82ec0-193">コマンドレットには、 `Set-Item` 実行時に動的に指定される追加のパラメーターが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-193">Sometimes the `Set-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="82ec0-194">これらの動的パラメーターを指定するには、Windows PowerShell 項目プロバイダーで [Setitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItemDynamicParameters) メソッドを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-194">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Setitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItemDynamicParameters) method.</span></span> <span data-ttu-id="82ec0-195">このメソッドは、指定されたパスにある項目の動的パラメーターを取得し、コマンドレットクラスまたは system.servicemodel 型の Parameterdictionary と同様に解析属性を持つプロパティとフィールドを持つオブジェクトを返します。 [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="82ec0-195">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="82ec0-196">Windows PowerShell ランタイムは、返されたオブジェクトを使用して、コマンドレットにパラメーターを追加し `Set-Item` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-196">The Windows PowerShell runtime uses the returned object to add the parameters to the `Set-Item` cmdlet.</span></span>

<span data-ttu-id="82ec0-197">このプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="82ec0-197">This provider does not implement this method.</span></span> <span data-ttu-id="82ec0-198">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="82ec0-198">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidersetitemdynamicparameters](Msh_samplestestcmdlets#testprovidersetitemdynamicparameters)]  -->

## <a name="clearing-an-item"></a><span data-ttu-id="82ec0-199">項目のクリア</span><span class="sxs-lookup"><span data-stu-id="82ec0-199">Clearing an Item</span></span>

<span data-ttu-id="82ec0-200">項目をクリアするには、Windows PowerShell 項目プロバイダーが、コマンドレットからの呼び出しをサポートするために、system.object を実装します。 [Clearitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem)メソッドを実装します。 `Clear-Item`</span><span class="sxs-lookup"><span data-stu-id="82ec0-200">To clear an item, the Windows PowerShell item provider implements the [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) method to support calls from the `Clear-Item` cmdlet.</span></span> <span data-ttu-id="82ec0-201">このメソッドは、指定されたパスのデータ項目を消去します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-201">This method erases the data item at the specified path.</span></span>

<span data-ttu-id="82ec0-202">このプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="82ec0-202">This provider does not implement this method.</span></span> <span data-ttu-id="82ec0-203">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="82ec0-203">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderclearitem](Msh_samplestestcmdlets#testproviderclearitem)]  -->

#### <a name="things-to-remember-about-implementing-clearitem"></a><span data-ttu-id="82ec0-204">ClearItem の実装に関する注意事項</span><span class="sxs-lookup"><span data-stu-id="82ec0-204">Things to Remember About Implementing ClearItem</span></span>

<span data-ttu-id="82ec0-205">次の条件は、システムの実装に適用される場合があります。 [clearitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem):</span><span class="sxs-lookup"><span data-stu-id="82ec0-205">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem):</span></span>

- <span data-ttu-id="82ec0-206">プロバイダークラスを定義すると、Windows PowerShell 項目プロバイダーは、ExpandWildcards カード、フィルター、包含、または除外のプロバイダー機能を、 [システム](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) の列挙体から宣言できます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-206">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="82ec0-207">このような場合、 [システム](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) の実装では、メソッドに渡されるパスが要件を満たしていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-207">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="82ec0-208">これを行うには、メソッドが適切なプロパティにアクセスする必要があります。たとえば、 ["..](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .............................................. [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) ...</span><span class="sxs-lookup"><span data-stu-id="82ec0-208">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="82ec0-209">既定では、このメソッドのオーバーライドでは、ユーザーに表示されないオブジェクトを設定または作成することはできません。この場合、 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) プロパティがに設定されている必要があり `true` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-209">By default, overrides of this method should not set or write objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="82ec0-210">パスが、ユーザーおよび [WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) \* によって非表示になっている項目を表している場合、このメソッドにはエラーを送信する必要があります。 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) はに設定され `false` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-210">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="82ec0-211">[Setitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem)メソッドを実装するには、システムを呼び出す必要があり[ます。](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)その場合は、データストアに変更を加える前に、その戻り値を確認してから、その戻り値を確認してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-211">Your implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="82ec0-212">このメソッドは、ファイルの削除など、データストアに変更が加えられたときの操作の実行を確認するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-212">This method is used to confirm execution of an operation when a change is made to the data store, for example, deleting files.</span></span> <span data-ttu-id="82ec0-213">[System.](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) ........................................................</span><span class="sxs-lookup"><span data-stu-id="82ec0-213">The [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handle any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="82ec0-214">Setitem を呼び出すと、[が返され](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)ます。このメソッドは、system........................ を呼び出す `true` 必要があり[](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) [](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-214">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="82ec0-215">このメソッドは、ユーザーにメッセージを送信して、操作を続行する必要があるかどうかを確認するフィードバックを許可します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-215">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="82ec0-216">System.object を呼び出すと、危険性の高いシステム変更を追加で確認できるように[なります。](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)</span><span class="sxs-lookup"><span data-stu-id="82ec0-216">The call to [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="retrieve-dynamic-parameters-for-clearitem"></a><span data-ttu-id="82ec0-217">ClearItem の動的パラメーターの取得</span><span class="sxs-lookup"><span data-stu-id="82ec0-217">Retrieve Dynamic Parameters for ClearItem</span></span>

<span data-ttu-id="82ec0-218">コマンドレットには、 `Clear-Item` 実行時に動的に指定される追加のパラメーターが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-218">Sometimes the `Clear-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="82ec0-219">これらの動的パラメーターを指定するには、Windows PowerShell 項目プロバイダーで、システムを実装する必要があります。 [Clearitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItemDynamicParameters) メソッド。</span><span class="sxs-lookup"><span data-stu-id="82ec0-219">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Clearitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItemDynamicParameters) method.</span></span> <span data-ttu-id="82ec0-220">このメソッドは、指定されたパスにある項目の動的パラメーターを取得し、コマンドレットクラスまたは system.servicemodel 型の Parameterdictionary と同様に解析属性を持つプロパティとフィールドを持つオブジェクトを返します。 [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="82ec0-220">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="82ec0-221">Windows PowerShell ランタイムは、返されたオブジェクトを使用して、コマンドレットにパラメーターを追加し `Clear-Item` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-221">The Windows PowerShell runtime uses the returned object to add the parameters to the `Clear-Item` cmdlet.</span></span>

<span data-ttu-id="82ec0-222">この項目プロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="82ec0-222">This item provider does not implement this method.</span></span> <span data-ttu-id="82ec0-223">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="82ec0-223">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderclearitemdynamicparameters](Msh_samplestestcmdlets#testproviderclearitemdynamicparameters)]  -->

## <a name="performing-a-default-action-for-an-item"></a><span data-ttu-id="82ec0-224">項目の既定のアクションを実行する</span><span class="sxs-lookup"><span data-stu-id="82ec0-224">Performing a Default Action for an Item</span></span>

<span data-ttu-id="82ec0-225">Windows PowerShell 項目プロバイダーは、 [Invokedefaultaction \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) メソッドを実装して、コマンドレットからの呼び出しをサポートできます。これにより、 `Invoke-Item` プロバイダーは、指定されたパスにある項目に対して既定のアクションを実行できます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-225">A Windows PowerShell item provider can implement the [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) method to support calls from the `Invoke-Item` cmdlet, which allows the provider to perform a default action for the item at the specified path.</span></span> <span data-ttu-id="82ec0-226">たとえば、FileSystem プロバイダーは、このメソッドを使用して、特定の項目に対して ShellExecute を呼び出す場合があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-226">For example, the FileSystem provider might use this method to call ShellExecute for a specific item.</span></span>

<span data-ttu-id="82ec0-227">このプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="82ec0-227">This provider does not implement this method.</span></span> <span data-ttu-id="82ec0-228">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="82ec0-228">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderinvokedefaultaction](Msh_samplestestcmdlets#testproviderinvokedefaultaction)]  -->

#### <a name="things-to-remember-about-implementing-invokedefaultaction"></a><span data-ttu-id="82ec0-229">InvokeDefaultAction の実装に関する注意事項</span><span class="sxs-lookup"><span data-stu-id="82ec0-229">Things to Remember About Implementing InvokeDefaultAction</span></span>

<span data-ttu-id="82ec0-230">[Invokedefaultaction \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction)の実装には、次の条件が適用される場合があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-230">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction):</span></span>

- <span data-ttu-id="82ec0-231">プロバイダークラスを定義すると、Windows PowerShell 項目プロバイダーは、ExpandWildcards カード、フィルター、包含、または除外のプロバイダー機能を、 [システム](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) の列挙体から宣言できます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-231">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="82ec0-232">このような場合は、 [Invokedefaultaction \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) の実装によって、メソッドに渡されるパスが要件を満たしていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-232">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="82ec0-233">これを行うには、メソッドが適切なプロパティにアクセスする必要があります。たとえば、 ["..](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .............................................. [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) ...</span><span class="sxs-lookup"><span data-stu-id="82ec0-233">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="82ec0-234">既定では、このメソッドのオーバーライドでは、ユーザーに対して非表示のオブジェクトを設定または作成することはできません。ただし、 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) プロパティがに設定されている必要があり `true` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-234">By default, overrides of this method should not set or write objects hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="82ec0-235">パスが、ユーザーおよび [WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) \* によって非表示になっている項目を表している場合、このメソッドにはエラーを送信する必要があります。 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) はに設定され `false` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-235">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="retrieve-dynamic-parameters-for-invokedefaultaction"></a><span data-ttu-id="82ec0-236">InvokeDefaultAction の動的パラメーターの取得</span><span class="sxs-lookup"><span data-stu-id="82ec0-236">Retrieve Dynamic Parameters for InvokeDefaultAction</span></span>

<span data-ttu-id="82ec0-237">コマンドレットには、 `Invoke-Item` 実行時に動的に指定される追加のパラメーターが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-237">Sometimes the `Invoke-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="82ec0-238">これらの動的パラメーターを指定するには、Windows PowerShell 項目プロバイダーでは、system.string [\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultActionDynamicParameters) メソッドを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-238">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultactiondynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultActionDynamicParameters) method.</span></span> <span data-ttu-id="82ec0-239">このメソッドは、指定されたパスにある項目の動的パラメーターを取得し、コマンドレットクラスまたは system.servicemodel 型の Parameterdictionary と同様に解析属性を持つプロパティとフィールドを持つオブジェクトを返します。 [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="82ec0-239">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="82ec0-240">Windows PowerShell ランタイムは、返されたオブジェクトを使用して、コマンドレットに動的パラメーターを追加し `Invoke-Item` ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-240">The Windows PowerShell runtime uses the returned object to add the dynamic parameters to the `Invoke-Item` cmdlet.</span></span>

<span data-ttu-id="82ec0-241">この項目プロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="82ec0-241">This item provider does not implement this method.</span></span> <span data-ttu-id="82ec0-242">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="82ec0-242">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderinvokedefaultactiondynamicparameters](Msh_samplestestcmdlets#testproviderinvokedefaultactiondynamicparameters)]  -->

## <a name="implementing-helper-methods-and-classes"></a><span data-ttu-id="82ec0-243">ヘルパーメソッドとクラスの実装</span><span class="sxs-lookup"><span data-stu-id="82ec0-243">Implementing Helper Methods and Classes</span></span>

<span data-ttu-id="82ec0-244">この項目プロバイダーは、Windows PowerShell で定義されているパブリックオーバーライドメソッドによって使用されるいくつかのヘルパーメソッドとクラスを実装します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-244">This item provider implements several helper methods and classes that are used by the public override methods defined by Windows PowerShell.</span></span> <span data-ttu-id="82ec0-245">これらのヘルパーメソッドとクラスのコードについては、「 [コードサンプル](#code-sample) 」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-245">The code for these helper methods and classes are shown in the [Code Sample](#code-sample) section.</span></span>

### <a name="normalizepath-method"></a><span data-ttu-id="82ec0-246">NormalizePath メソッド</span><span class="sxs-lookup"><span data-stu-id="82ec0-246">NormalizePath Method</span></span>

<span data-ttu-id="82ec0-247">この項目プロバイダーは、パスが一貫した形式であることを保証するために、NormalizePath ヘルパーメソッドを実装します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-247">This item provider implements a NormalizePath helper method to ensure that the path has a consistent format.</span></span> <span data-ttu-id="82ec0-248">指定された形式では、区切り記号として円記号 () が使用され \\ ます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-248">The format specified uses a backslash (\\) as a separator.</span></span>

### <a name="pathisdrive-method"></a><span data-ttu-id="82ec0-249">PathIsDrive メソッド</span><span class="sxs-lookup"><span data-stu-id="82ec0-249">PathIsDrive Method</span></span>

<span data-ttu-id="82ec0-250">この項目プロバイダーは、PathIsDrive ヘルパーメソッドを実装して、指定されたパスが実際にドライブ名であるかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-250">This item provider implements a PathIsDrive helper method to determine if the specified path is actually the drive name.</span></span>

### <a name="chunkpath-method"></a><span data-ttu-id="82ec0-251">ChunkPath メソッド</span><span class="sxs-lookup"><span data-stu-id="82ec0-251">ChunkPath Method</span></span>

<span data-ttu-id="82ec0-252">この項目プロバイダーは、プロバイダーが個々の要素を識別できるように、指定されたパスを分割する ChunkPath ヘルパーメソッドを実装します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-252">This item provider implements a ChunkPath helper method that breaks up the specified path so that the provider can identify its individual elements.</span></span> <span data-ttu-id="82ec0-253">パス要素で構成される配列を返します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-253">It returns an array composed of the path elements.</span></span>

### <a name="gettable-method"></a><span data-ttu-id="82ec0-254">GetTable メソッド</span><span class="sxs-lookup"><span data-stu-id="82ec0-254">GetTable Method</span></span>

<span data-ttu-id="82ec0-255">この項目プロバイダーは、呼び出しで指定されたテーブルに関する情報を表すデータオブジェクトを返す、GetTables ヘルパーメソッドを実装します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-255">This item provider implements the GetTables helper method that returns a DatabaseTableInfo object that represents information about the table specified in the call.</span></span>

### <a name="getrow-method"></a><span data-ttu-id="82ec0-256">GetRow メソッド</span><span class="sxs-lookup"><span data-stu-id="82ec0-256">GetRow Method</span></span>

<span data-ttu-id="82ec0-257">この項目プロバイダーの system.servicemodel............... この [メソッドは、](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) GetRows ヘルパーメソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-257">The [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method of this item provider calls the GetRows helper method.</span></span> <span data-ttu-id="82ec0-258">このヘルパーメソッドは、テーブル内の指定された行に関する情報を表す DatabaseRowInfo オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-258">This helper method retrieves a DatabaseRowInfo object that represents information about the specified row in the table.</span></span>

### <a name="databasetableinfo-class"></a><span data-ttu-id="82ec0-259">"クラス"</span><span class="sxs-lookup"><span data-stu-id="82ec0-259">DatabaseTableInfo Class</span></span>

<span data-ttu-id="82ec0-260">この項目プロバイダーは、データベース内のデータテーブル内の情報のコレクションを表すデータセットを定義します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-260">This item provider defines a DatabaseTableInfo class that represents a collection of information in a data table in the database.</span></span> <span data-ttu-id="82ec0-261">このクラスは、 [Directoryinfo](/dotnet/api/System.IO.DirectoryInfo) クラスに似ています。</span><span class="sxs-lookup"><span data-stu-id="82ec0-261">This class is similar to the [System.IO.Directoryinfo](/dotnet/api/System.IO.DirectoryInfo) class.</span></span>

<span data-ttu-id="82ec0-262">サンプル項目プロバイダーは、データベース内のテーブルを定義するテーブル情報オブジェクトのコレクションを返す、データセットメソッドを定義します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-262">The sample item provider defines a DatabaseTableInfo.GetTables method that returns a collection of table information objects defining the tables in the database.</span></span> <span data-ttu-id="82ec0-263">このメソッドには try/catch ブロックが含まれており、すべてのデータベースエラーがエントリが0の行として表示されるようになっています。</span><span class="sxs-lookup"><span data-stu-id="82ec0-263">This method includes a try/catch block to ensure that any database error shows up as a row with zero entries.</span></span>

### <a name="databaserowinfo-class"></a><span data-ttu-id="82ec0-264">DatabaseRowInfo クラス</span><span class="sxs-lookup"><span data-stu-id="82ec0-264">DatabaseRowInfo Class</span></span>

<span data-ttu-id="82ec0-265">このアイテムプロバイダーは、データベースのテーブルの行を表す DatabaseRowInfo helper クラスを定義します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-265">This item provider defines the DatabaseRowInfo helper class that represents a row in a table of the database.</span></span> <span data-ttu-id="82ec0-266">このクラス [は、system.servicemodel](/dotnet/api/System.IO.FileInfo) クラスに似ています。</span><span class="sxs-lookup"><span data-stu-id="82ec0-266">This class is similar to the [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) class.</span></span>

<span data-ttu-id="82ec0-267">サンプルプロバイダーは、指定されたテーブルの行情報オブジェクトのコレクションを返す DatabaseRowInfo メソッドを定義します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-267">The sample provider defines a DatabaseRowInfo.GetRows method to return a collection of row information objects for the specified table.</span></span> <span data-ttu-id="82ec0-268">このメソッドには、例外をトラップするための try/catch ブロックが含まれています。</span><span class="sxs-lookup"><span data-stu-id="82ec0-268">This method includes a try/catch block to trap exceptions.</span></span> <span data-ttu-id="82ec0-269">エラーが発生すると、行情報は生成されません。</span><span class="sxs-lookup"><span data-stu-id="82ec0-269">Any errors will result in no row information.</span></span>

## <a name="code-sample"></a><span data-ttu-id="82ec0-270">コード サンプル</span><span class="sxs-lookup"><span data-stu-id="82ec0-270">Code Sample</span></span>

<span data-ttu-id="82ec0-271">完全なサンプルコードについては、「 [AccessDbProviderSample03 のコードサンプル](./accessdbprovidersample03-code-sample.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-271">For complete sample code, see [AccessDbProviderSample03 Code Sample](./accessdbprovidersample03-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="82ec0-272">オブジェクトの種類と書式設定の定義</span><span class="sxs-lookup"><span data-stu-id="82ec0-272">Defining Object Types and Formatting</span></span>

<span data-ttu-id="82ec0-273">プロバイダーを作成する場合は、既存のオブジェクトにメンバーを追加したり、新しいオブジェクトを定義したりすることが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-273">When writing a provider, it may be necessary to add members to existing objects or define new objects.</span></span> <span data-ttu-id="82ec0-274">完了したら、Windows PowerShell がオブジェクトのメンバーを識別するために使用できる型ファイルと、オブジェクトの表示方法を定義するフォーマットファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="82ec0-274">When finished, create a Types file that Windows PowerShell can use to identify the members of the object and a Format file that defines how the object is displayed.</span></span> <span data-ttu-id="82ec0-275">の詳細については、「 [オブジェクトの種類と書式設定の拡張](/previous-versions/ms714665(v=vs.85))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-275">For more information about , see [Extending Object Types and Formatting](/previous-versions/ms714665(v=vs.85)).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="82ec0-276">Windows PowerShell プロバイダーの構築</span><span class="sxs-lookup"><span data-stu-id="82ec0-276">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="82ec0-277">「 [コマンドレット、プロバイダー、およびホストアプリケーションを登録する方法」を](/previous-versions/ms714644(v=vs.85))参照してください。</span><span class="sxs-lookup"><span data-stu-id="82ec0-277">See [How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85)).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="82ec0-278">Windows PowerShell プロバイダーのテスト</span><span class="sxs-lookup"><span data-stu-id="82ec0-278">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="82ec0-279">この Windows PowerShell 項目プロバイダーが Windows PowerShell に登録されている場合、プロバイダーの基本およびドライブの機能のみをテストできます。</span><span class="sxs-lookup"><span data-stu-id="82ec0-279">When this Windows PowerShell item provider is registered with Windows PowerShell, you can only test the basic and drive functionality of the provider.</span></span> <span data-ttu-id="82ec0-280">項目の操作をテストするには、「 [コンテナーの Windows PowerShell プロバイダーの実装](./creating-a-windows-powershell-container-provider.md)」で説明されているコンテナー機能も実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ec0-280">To test the manipulation of items, you must also implement container functionality described in [Implementing a Container Windows PowerShell Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="82ec0-281">参照</span><span class="sxs-lookup"><span data-stu-id="82ec0-281">See Also</span></span>

[<span data-ttu-id="82ec0-282">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="82ec0-282">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="82ec0-283">Windows PowerShell プログラマー ガイド</span><span class="sxs-lookup"><span data-stu-id="82ec0-283">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="82ec0-284">Windows PowerShell プロバイダーの作成</span><span class="sxs-lookup"><span data-stu-id="82ec0-284">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="82ec0-285">Windows PowerShell プロバイダーの設計</span><span class="sxs-lookup"><span data-stu-id="82ec0-285">Designing Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

<span data-ttu-id="82ec0-286">[オブジェクトの種類と書式設定の拡張](/previous-versions/ms714665(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="82ec0-286">[Extending Object Types and Formatting](/previous-versions/ms714665(v=vs.85))</span></span>

<span data-ttu-id="82ec0-287">[Windows PowerShell の動作](/previous-versions/ms714658(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="82ec0-287">[How Windows PowerShell Works](/previous-versions/ms714658(v=vs.85))</span></span>

[<span data-ttu-id="82ec0-288">コンテナーの Windows PowerShell プロバイダーの作成</span><span class="sxs-lookup"><span data-stu-id="82ec0-288">Creating a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="82ec0-289">ドライブ Windows PowerShell プロバイダーの作成</span><span class="sxs-lookup"><span data-stu-id="82ec0-289">Creating a Drive Windows PowerShell provider</span></span>](./creating-a-windows-powershell-drive-provider.md)

<span data-ttu-id="82ec0-290">[コマンドレット、プロバイダー、およびホストアプリケーションを登録する方法](/previous-versions/ms714644(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="82ec0-290">[How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85))</span></span>
