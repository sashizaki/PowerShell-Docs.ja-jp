---
ms.date: 09/13/2016
ms.topic: reference
title: Windows PowerShell プロパティ プロバイダーを作成する
description: Windows PowerShell プロパティ プロバイダーを作成する
ms.openlocfilehash: 5370624afa784598ca784b201f7e7345eb958ff9
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2020
ms.locfileid: "94390917"
---
# <a name="creating-a-windows-powershell-property-provider"></a><span data-ttu-id="39660-103">Windows PowerShell プロパティ プロバイダーを作成する</span><span class="sxs-lookup"><span data-stu-id="39660-103">Creating a Windows PowerShell Property Provider</span></span>

<span data-ttu-id="39660-104">このトピックでは、ユーザーがデータストア内の項目のプロパティを操作できるようにするプロバイダーを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="39660-104">This topic describes how to create a provider that enables the user to manipulate the properties of items in a data store.</span></span> <span data-ttu-id="39660-105">その結果、この種類のプロバイダーは、Windows PowerShell プロパティプロバイダーと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="39660-105">As a consequence, this type of provider is referred to as a Windows PowerShell property provider.</span></span> <span data-ttu-id="39660-106">たとえば、Windows PowerShell によって提供されるレジストリプロバイダーは、レジストリキーの値をレジストリキー項目のプロパティとして処理します。</span><span class="sxs-lookup"><span data-stu-id="39660-106">For example, the Registry provider provided by Windows PowerShell handles registry key values as properties of the registry key item.</span></span> <span data-ttu-id="39660-107">この種類のプロバイダーは、 [Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) インターフェイスを .net クラスの実装に追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-107">This type of provider must add the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface to the implementation of the .NET class.</span></span>

> [!NOTE]
> <span data-ttu-id="39660-108">Windows PowerShell には、Windows PowerShell プロバイダーの開発に使用できるテンプレートファイルが用意されています。</span><span class="sxs-lookup"><span data-stu-id="39660-108">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="39660-109">TemplateProvider.cs ファイルは、Microsoft Windows Software Development Kit for Windows Vista および .NET Framework 3.0 ランタイムコンポーネントで使用できます。</span><span class="sxs-lookup"><span data-stu-id="39660-109">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="39660-110">ダウンロードの手順については、「 [Windows powershell をインストールする方法」および「Windows POWERSHELL SDK をダウンロードする方法](/powershell/scripting/developer/installing-the-windows-powershell-sdk)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="39660-110">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="39660-111">ダウンロードしたテンプレートは、ディレクトリにあり **\<PowerShell Samples>** ます。</span><span class="sxs-lookup"><span data-stu-id="39660-111">The downloaded template is available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="39660-112">このファイルのコピーを作成し、新しい Windows PowerShell プロバイダーを作成するためにコピーを使用して、不要な機能を削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-112">You should make a copy of this file and use the copy for creating a new Windows PowerShell provider, removing any functionality that you do not need.</span></span> <span data-ttu-id="39660-113">その他の Windows PowerShell プロバイダーの実装の詳細については、「 [Windows Powershell プロバイダーの設計](./designing-your-windows-powershell-provider.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="39660-113">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

> [!CAUTION]
> <span data-ttu-id="39660-114">プロパティプロバイダーのメソッドは、System........................ [Writepropertyobject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) メソッドを使用してオブジェクトを書き込む必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-114">The methods of your property provider should write any objects using the [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) method.</span></span>

## <a name="defining-the-windows-powershell-provider"></a><span data-ttu-id="39660-115">Windows PowerShell プロバイダーの定義</span><span class="sxs-lookup"><span data-stu-id="39660-115">Defining the Windows PowerShell provider</span></span>

<span data-ttu-id="39660-116">プロパティプロバイダーは、 [Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) インターフェイスをサポートする .net クラスを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-116">A property provider must create a .NET class that supports the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span></span> <span data-ttu-id="39660-117">Windows PowerShell によって提供される TemplateProvider.cs ファイルの既定のクラス宣言を次に示します。</span><span class="sxs-lookup"><span data-stu-id="39660-117">Here is the default class declaration from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration](Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration)]  -->

## <a name="defining-base-functionality"></a><span data-ttu-id="39660-118">基本機能の定義</span><span class="sxs-lookup"><span data-stu-id="39660-118">Defining Base Functionality</span></span>

<span data-ttu-id="39660-119">[Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)インターフェイスは、Drivecmdletprovider クラスを除き、どのプロバイダーの基底クラスにもアタッチできます。このインターフェイスには、 [](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)クラスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="39660-119">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface can be attached to any of the provider base classes, with the exception of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class.</span></span> <span data-ttu-id="39660-120">使用する基本クラスに必要な基本機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="39660-120">Add the base functionality that is required by the base class you are using.</span></span> <span data-ttu-id="39660-121">基本クラスの詳細については、「 [Windows PowerShell プロバイダーの設計](./designing-your-windows-powershell-provider.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="39660-121">For more information about base classes, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

## <a name="retrieving-properties"></a><span data-ttu-id="39660-122">プロパティの取得</span><span class="sxs-lookup"><span data-stu-id="39660-122">Retrieving Properties</span></span>

<span data-ttu-id="39660-123">プロパティを取得するには、プロバイダーが[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)メソッドを実装して、コマンドレットからの呼び出しをサポートする必要があります。 `Get-ItemProperty`</span><span class="sxs-lookup"><span data-stu-id="39660-123">To retrieve properties, the provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method to support calls from the `Get-ItemProperty` cmdlet.</span></span> <span data-ttu-id="39660-124">このメソッドは、指定されたプロバイダー内部パス (完全修飾) にある項目のプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="39660-124">This method retrieves the properties of the item located at the specified provider-internal path (fully-qualified).</span></span>

<span data-ttu-id="39660-125">パラメーターは、 `providerSpecificPickList` 取得するプロパティを示します。</span><span class="sxs-lookup"><span data-stu-id="39660-125">The `providerSpecificPickList` parameter indicates which properties to retrieve.</span></span> <span data-ttu-id="39660-126">このパラメーターが `null` または空の場合、メソッドはすべてのプロパティを取得する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-126">If this parameter is `null` or empty, the method should retrieve all properties.</span></span> <span data-ttu-id="39660-127">さらに、 [Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) は、取得されたプロパティのプロパティバッグを表す、 [system.servicemodel オブジェクトの](/dotnet/api/System.Management.Automation.PSObject) インスタンスを書き込んでいることを意味しています。</span><span class="sxs-lookup"><span data-stu-id="39660-127">In addition, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the retrieved properties.</span></span> <span data-ttu-id="39660-128">メソッドは何も返しません。</span><span class="sxs-lookup"><span data-stu-id="39660-128">The method should return nothing.</span></span>

<span data-ttu-id="39660-129">[Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)の実装では、選択リストの各要素に対して、プロパティ名のワイルドカード展開がサポートされていることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="39660-129">It is recommended that the implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) supports the wildcard expansion of property names for each element in the pick list.</span></span> <span data-ttu-id="39660-130">これを行うには、 [Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) クラスを使用して、ワイルドカードのパターンマッチングを実行します。</span><span class="sxs-lookup"><span data-stu-id="39660-130">To do this, use the [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) class to perform the wildcard pattern matching.</span></span>

<span data-ttu-id="39660-131">Windows PowerShell によって提供される TemplateProvider.cs ファイルからの [Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) の既定の実装を次に示します。</span><span class="sxs-lookup"><span data-stu-id="39660-131">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty)]  -->

#### <a name="things-to-remember-about-implementing-getproperty"></a><span data-ttu-id="39660-132">GetProperty の実装に関する注意事項</span><span class="sxs-lookup"><span data-stu-id="39660-132">Things to Remember About Implementing GetProperty</span></span>

<span data-ttu-id="39660-133">[Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)の実装には、次の条件が当てはまる場合があります。</span><span class="sxs-lookup"><span data-stu-id="39660-133">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span></span>

- <span data-ttu-id="39660-134">プロバイダークラスを定義すると、Windows PowerShell プロパティプロバイダーは、ExpandWildcards カード、フィルター、包含、または除外のプロバイダー機能を、 [システム](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) の列挙体から宣言できます。</span><span class="sxs-lookup"><span data-stu-id="39660-134">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="39660-135">このような場合、 [Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) メソッドの実装では、メソッドに渡されるパスが、指定された機能の要件を満たしていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-135">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="39660-136">これを行うには、メソッドが適切なプロパティにアクセスする必要があります。たとえば、 ["..](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .............................................. [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) ...</span><span class="sxs-lookup"><span data-stu-id="39660-136">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="39660-137">既定では、このメソッドをオーバーライドしても、ユーザーに表示されないオブジェクトのリーダーを取得することはできません。この場合、 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) プロパティがに設定されている必要があり `true` ます。</span><span class="sxs-lookup"><span data-stu-id="39660-137">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="39660-138">パスが、ユーザーおよびシステムから非表示になっている項目を表している場合は、エラーを書き込む必要があります。 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)をに設定します。 `false`</span><span class="sxs-lookup"><span data-stu-id="39660-138">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-itemproperty-cmdlet"></a><span data-ttu-id="39660-139">Get-ItemProperty コマンドレットへの動的パラメーターのアタッチ</span><span class="sxs-lookup"><span data-stu-id="39660-139">Attaching Dynamic Parameters to the Get-ItemProperty Cmdlet</span></span>

<span data-ttu-id="39660-140">`Get-ItemProperty`コマンドレットでは、実行時に動的に指定される追加のパラメーターが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="39660-140">The `Get-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="39660-141">これらの動的パラメーターを指定するには、Windows PowerShell プロパティプロバイダーで [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) メソッドを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-141">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="39660-142">パラメーターは、 `path` 完全修飾プロバイダーの内部パスを示し `providerSpecificPickList` ます。パラメーターは、コマンドラインで入力されたプロバイダー固有のプロパティを指定します。</span><span class="sxs-lookup"><span data-stu-id="39660-142">The `path` parameter indicates a fully-qualified provider-internal path, while the `providerSpecificPickList` parameter specifies the provider-specific properties entered on the command line.</span></span> <span data-ttu-id="39660-143">`null`プロパティがコマンドレットにパイプされている場合、このパラメーターはまたは空になることがあります。</span><span class="sxs-lookup"><span data-stu-id="39660-143">This parameter might be `null` or empty if the properties are piped to the cmdlet.</span></span> <span data-ttu-id="39660-144">この場合、このメソッドは、コマンドレットクラスまたは system.servicemodel 型の [Parameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) オブジェクトと同様に解析属性を持つプロパティとフィールドを持つオブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="39660-144">In this case, this method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="39660-145">Windows PowerShell ランタイムは、返されたオブジェクトを使用して、コマンドレットにパラメーターを追加します。</span><span class="sxs-lookup"><span data-stu-id="39660-145">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="39660-146">ここでは、Windows PowerShell によって提供される TemplateProvider.cs ファイルからの [Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) の既定の実装を示します。</span><span class="sxs-lookup"><span data-stu-id="39660-146">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters)]  -->

## <a name="setting-properties"></a><span data-ttu-id="39660-147">プロパティの設定</span><span class="sxs-lookup"><span data-stu-id="39660-147">Setting Properties</span></span>

<span data-ttu-id="39660-148">プロパティを設定するには、コマンドレットからの呼び出しをサポートするために、Windows PowerShell プロパティプロバイダーで [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) メソッドを実装する必要があり `Set-ItemProperty` ます。</span><span class="sxs-lookup"><span data-stu-id="39660-148">To set properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method to support calls from the `Set-ItemProperty` cmdlet.</span></span> <span data-ttu-id="39660-149">このメソッドは、指定されたパスにある項目の1つ以上のプロパティを設定し、必要に応じて、指定されたプロパティを上書きします。</span><span class="sxs-lookup"><span data-stu-id="39660-149">This method sets one or more properties of the item at the specified path, and overwrites the supplied properties as required.</span></span>
<span data-ttu-id="39660-150">また、 [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)は、更新されたプロパティのプロパティバッグを表す、system.servicemodel[オブジェクトの](/dotnet/api/System.Management.Automation.PSObject)インスタンスも書き込みます。このオブジェクトは、更新されたプロパティのプロパティバッグを表します。</span><span class="sxs-lookup"><span data-stu-id="39660-150">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) also writes an instance of a [System.Management.Automation.PSObject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the updated properties.</span></span>

<span data-ttu-id="39660-151">ここでは、Windows PowerShell によって提供される TemplateProvider.cs ファイルからの [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) の既定の実装を示します。</span><span class="sxs-lookup"><span data-stu-id="39660-151">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty)]  -->

#### <a name="things-to-remember-about-implementing-set-itemproperty"></a><span data-ttu-id="39660-152">Set-ItemProperty の実装について覚えておくべきこと</span><span class="sxs-lookup"><span data-stu-id="39660-152">Things to Remember About Implementing Set-ItemProperty</span></span>

<span data-ttu-id="39660-153">[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)の実装には、次の条件が当てはまる場合があります。</span><span class="sxs-lookup"><span data-stu-id="39660-153">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span></span>

- <span data-ttu-id="39660-154">プロバイダークラスを定義すると、Windows PowerShell プロパティプロバイダーは、ExpandWildcards カード、フィルター、包含、または除外のプロバイダー機能を、 [システム](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) の列挙体から宣言できます。</span><span class="sxs-lookup"><span data-stu-id="39660-154">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="39660-155">このような場合は、 [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) メソッドを実装することで、メソッドに渡されるパスが指定された機能の要件を満たしていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-155">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="39660-156">これを行うには、メソッドが適切なプロパティにアクセスする必要があります。たとえば、 ["..](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .............................................. [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) ...</span><span class="sxs-lookup"><span data-stu-id="39660-156">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="39660-157">既定では、このメソッドをオーバーライドしても、ユーザーに表示されないオブジェクトのリーダーを取得することはできません。この場合、 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) プロパティがに設定されている必要があり `true` ます。</span><span class="sxs-lookup"><span data-stu-id="39660-157">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="39660-158">パスが、ユーザーおよびシステムから非表示になっている項目を表している場合は、エラーを書き込む必要があります。 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)をに設定します。 `false`</span><span class="sxs-lookup"><span data-stu-id="39660-158">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="39660-159">[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)メソッドを実装するには、システムを呼び出す必要があります。データストアに変更を加える前に、その戻り値を確認し、その戻り値を確認し[ます。](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)</span><span class="sxs-lookup"><span data-stu-id="39660-159">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="39660-160">このメソッドは、ファイル名の変更など、システム状態が変更されたときの操作の実行を確認するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="39660-160">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span>
  <span data-ttu-id="39660-161">Windows PowerShell ランタイムを使用して、ユーザーに変更されるリソースの名前を送信し、表示される内容を決定するためにコマンドライン設定またはユーザー設定変数を処理して[います。](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)</span><span class="sxs-lookup"><span data-stu-id="39660-161">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="39660-162">Ipropertycmdletprovider の呼び出しによってが返された後、危険性の高いシステム変更を行うことができる場合は、システムを呼び出す必要があります。その[ためには](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)、 `true` [](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)メソッドを呼び出す必要[](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)があります。このメソッドを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-162">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="39660-163">このメソッドは、ユーザーに確認メッセージを送信して、操作を続行する必要があることを示す追加のフィードバックを許可します。</span><span class="sxs-lookup"><span data-stu-id="39660-163">This method sends a confirmation message to the user to allow additional feedback to indicate that the operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-for-the-set-itemproperty-cmdlet"></a><span data-ttu-id="39660-164">Set-ItemProperty コマンドレットの動的パラメーターのアタッチ</span><span class="sxs-lookup"><span data-stu-id="39660-164">Attaching Dynamic Parameters for the Set-ItemProperty Cmdlet</span></span>

<span data-ttu-id="39660-165">`Set-ItemProperty`コマンドレットでは、実行時に動的に指定される追加のパラメーターが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="39660-165">The `Set-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="39660-166">これらの動的パラメーターを指定するには、Windows PowerShell プロパティプロバイダーで [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) メソッドを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-166">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="39660-167">このメソッドは、コマンドレットクラスや [system.string オブジェクトと](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) 同様に解析属性を持つプロパティとフィールドを持つオブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="39660-167">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="39660-168">`null`動的パラメーターを追加する必要がない場合は、値を返すことができます。</span><span class="sxs-lookup"><span data-stu-id="39660-168">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="39660-169">ここでは、Windows PowerShell によって提供される TemplateProvider.cs ファイルからの [Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) の既定の実装を示します。</span><span class="sxs-lookup"><span data-stu-id="39660-169">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters)]  -->

## <a name="clearing-properties"></a><span data-ttu-id="39660-170">プロパティのクリア</span><span class="sxs-lookup"><span data-stu-id="39660-170">Clearing Properties</span></span>

<span data-ttu-id="39660-171">プロパティをクリアするには、コマンドレットからの呼び出しをサポートするために、Windows PowerShell プロパティプロバイダーで [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) メソッドを実装する必要があり `Clear-ItemProperty` ます。</span><span class="sxs-lookup"><span data-stu-id="39660-171">To clear properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method to support calls from the `Clear-ItemProperty` cmdlet.</span></span> <span data-ttu-id="39660-172">このメソッドは、指定されたパスにある項目の1つ以上のプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="39660-172">This method sets one or more properties for the item located at the specified path.</span></span>

<span data-ttu-id="39660-173">Windows PowerShell によって提供される TemplateProvider.cs ファイルの [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) の既定の実装を次に示します。</span><span class="sxs-lookup"><span data-stu-id="39660-173">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty](Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty)]  -->

#### <a name="thing-to-remember-about-implementing-clearproperty"></a><span data-ttu-id="39660-174">ClearProperty の実装について覚えておくべきこと</span><span class="sxs-lookup"><span data-stu-id="39660-174">Thing to Remember About Implementing ClearProperty</span></span>

<span data-ttu-id="39660-175">[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)の実装には、次の条件が当てはまる場合があります。</span><span class="sxs-lookup"><span data-stu-id="39660-175">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span></span>

- <span data-ttu-id="39660-176">プロバイダークラスを定義すると、Windows PowerShell プロパティプロバイダーは、ExpandWildcards カード、フィルター、包含、または除外のプロバイダー機能を、 [システム](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) の列挙体から宣言できます。</span><span class="sxs-lookup"><span data-stu-id="39660-176">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="39660-177">このような場合、 [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) メソッドを実装するには、メソッドに渡されるパスが、指定された機能の要件を満たしていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-177">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="39660-178">これを行うには、メソッドが適切なプロパティにアクセスする必要があります。たとえば、 ["..](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .............................................. [...](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) ...</span><span class="sxs-lookup"><span data-stu-id="39660-178">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="39660-179">既定では、このメソッドをオーバーライドしても、ユーザーに表示されないオブジェクトのリーダーを取得することはできません。この場合、 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) プロパティがに設定されている必要があり `true` ます。</span><span class="sxs-lookup"><span data-stu-id="39660-179">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="39660-180">パスが、ユーザーおよびシステムから非表示になっている項目を表している場合は、エラーを書き込む必要があります。 [Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)をに設定します。 `false`</span><span class="sxs-lookup"><span data-stu-id="39660-180">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="39660-181">[Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)メソッドを実装するには、その前に system.object[を呼び出して](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)、データストアに変更を加える前に戻り値を確認する必要があるということを確認してください。</span><span class="sxs-lookup"><span data-stu-id="39660-181">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="39660-182">このメソッドは、コンテンツのクリアなど、システム状態が変更される前に操作の実行を確認するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="39660-182">This method is used to confirm execution of an operation before a change is made to system state, such as clearing content.</span></span>
  <span data-ttu-id="39660-183">このコマンドは、変更されるリソースの名前をユーザー[に送信します。 Windows](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) PowerShell ランタイムは、表示する内容を決定する際に、コマンドライン設定やユーザー設定変数を考慮します。</span><span class="sxs-lookup"><span data-stu-id="39660-183">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="39660-184">Ipropertycmdletprovider の[呼び出しによってが返され](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)た後、危険なシステムの変更が発生する可能性がある場合は、システムを呼び出すメソッドを呼び出す必要があります。このメソッドは、......... `true` [.....。](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) [](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)</span><span class="sxs-lookup"><span data-stu-id="39660-184">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="39660-185">このメソッドは、ユーザーに確認メッセージを送信して、危険な可能性のある操作を続行する必要があることを示す追加のフィードバックを許可します。</span><span class="sxs-lookup"><span data-stu-id="39660-185">This method sends a confirmation message to the user to allow additional feedback to indicate that the potentially dangerous operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-itemproperty-cmdlet"></a><span data-ttu-id="39660-186">Clear-ItemProperty コマンドレットへの動的パラメーターのアタッチ</span><span class="sxs-lookup"><span data-stu-id="39660-186">Attaching Dynamic Parameters to the Clear-ItemProperty Cmdlet</span></span>

<span data-ttu-id="39660-187">`Clear-ItemProperty`コマンドレットでは、実行時に動的に指定される追加のパラメーターが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="39660-187">The `Clear-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="39660-188">これらの動的パラメーターを指定するには、Windows PowerShell プロパティプロバイダーで [Ipropertycmdletprovider \*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) メソッドを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="39660-188">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) method.</span></span> <span data-ttu-id="39660-189">このメソッドは、コマンドレットクラスや [system.string オブジェクトと](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) 同様に解析属性を持つプロパティとフィールドを持つオブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="39660-189">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="39660-190">`null`動的パラメーターを追加する必要がない場合は、値を返すことができます。</span><span class="sxs-lookup"><span data-stu-id="39660-190">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="39660-191">ここでは、Windows PowerShell によって提供される TemplateProvider.cs ファイルからの [Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) の既定の実装を示します。</span><span class="sxs-lookup"><span data-stu-id="39660-191">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters)]  -->

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="39660-192">Windows PowerShell プロバイダーの構築</span><span class="sxs-lookup"><span data-stu-id="39660-192">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="39660-193">「 [コマンドレット、プロバイダー、およびホストアプリケーションを登録する方法」を](/previous-versions//ms714644(v=vs.85))参照してください。</span><span class="sxs-lookup"><span data-stu-id="39660-193">See [How to Register Cmdlets, Providers, and Host Applications](/previous-versions//ms714644(v=vs.85)).</span></span>

## <a name="see-also"></a><span data-ttu-id="39660-194">参照</span><span class="sxs-lookup"><span data-stu-id="39660-194">See Also</span></span>

[<span data-ttu-id="39660-195">Windows PowerShell プロバイダー</span><span class="sxs-lookup"><span data-stu-id="39660-195">Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="39660-196">Windows PowerShell プロバイダーを設計する</span><span class="sxs-lookup"><span data-stu-id="39660-196">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

<span data-ttu-id="39660-197">[オブジェクトの種類と書式設定の拡張](/previous-versions//ms714665(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="39660-197">[Extending Object Types and Formatting](/previous-versions//ms714665(v=vs.85))</span></span>

<span data-ttu-id="39660-198">[コマンドレット、プロバイダー、およびホストアプリケーションを登録する方法](/previous-versions//ms714644(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="39660-198">[How to Register Cmdlets, Providers, and Host Applications](/previous-versions//ms714644(v=vs.85))</span></span>
