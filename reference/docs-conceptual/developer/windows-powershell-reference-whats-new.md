---
title: Windows PowerShell リファレンス-新機能
ms.date: 09/13/2016
ms.topic: article
ms.openlocfilehash: 364d081ddf2f87ceeaa47732266a35f4a126246f
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/05/2019
ms.locfileid: "72366091"
---
# <a name="whats-new"></a>新機能

Windows PowerShell 2.0 には、コマンドレット、プロバイダー、およびホストアプリケーションを記述するときに使用できる次の新機能が用意されています。

## <a name="modules"></a>モジュール

モジュールを使用して、Windows PowerShell ソリューションをパッケージ化して配布できるようになりました。 モジュールを使用すると、Windows PowerShell コードをパーティション分割し、自己完結型の再利用可能な単位にまとめることができます。 モジュールの詳細については、「Windows PowerShell モジュールの記述」を参照してください。

## <a name="the-powershell-class"></a>PowerShell クラス

PowerShell クラスは、ホストアプリケーションと呼ばれるアプリケーションを作成し、プログラムを使用してコマンドを実行するためのより簡単なソリューションを提供します。 このクラスを使用すると、コマンドのパイプラインを作成したり、コマンドの実行に使用する実行空間を指定したり、コマンドを同期的または非同期的に呼び出すように指定したりできます。

## <a name="the-runspacepool-class"></a>RunspacePool クラス

実行空間プールを使用すると、1回の呼び出しで複数の実行空間を作成できます。 Createrunspace プールメソッドには、同じホスト、初期セッション状態、接続情報など、同じ機能を持つ実行空間を作成するために使用できるいくつかのオーバーロードが用意されています。

## <a name="the-initialsessionstate-class"></a>InitialSessionState クラス

InitialSessionState クラスを使用すると、実行空間を開いたときに使用されるセッション状態の構成を作成できます。 カスタム構成、mshshort によって提供されるコマンドを含む既定の構成、およびセッションの機能に基づいてコマンドが制限されている構成を作成できます。

## <a name="remote-runspaces"></a>リモート実行空間

リモートコンピューターで開くことができる実行空間を作成できるようになりました。これにより、リモートコンピューターでコマンドを実行し、結果をローカルに収集できます。 リモート実行空間を作成するには、実行空間を作成するときに、リモート接続に関する情報を指定する必要があります。 例については、CreateRunspace および Createrunspace プールのメソッドを参照してください。 接続情報は、RunspaceConnectionInfo クラスによって定義されます。

## <a name="private-runspace-elements"></a>プライベート実行空間要素

要素がパブリックまたはプライベートである実行空間を作成できるようになりました。 これにより、実行空間で使用できる要素を持つ実行空間を作成できますが、ユーザーが使用することはできません。 実行空間のどの要素をプライベートにできるかを確認するには、ConstrainedSessionStateEntry クラスを参照してください。

## <a name="runspace-threading-modes-and-apartment-state"></a>実行空間スレッドモードとアパートメント状態

実行空間でコマンドを実行するときに、スレッドを作成して使用する方法を指定できるようになりました。 RunspacePool プロパティとプロパティを参照してください。このプロパティについては、「」を参照してください。

実行空間でコマンドを実行するために使用されるスレッドのアパートメント状態を取得できるようになりました。 System.threading.thread.apartmentstate プロパティと RunspacePool プロパティを参照してください。このプロパティについては、「」を参照してください。

## <a name="transaction-cmdlets"></a>トランザクションのコマンドレット

トランザクション内で使用できるコマンドレットを作成できるようになりました。 コマンドレットがトランザクションで使用されている場合、そのアクションは一時的なものであり、Windows PowerShell によって提供されるトランザクションコマンドレットによって受け入れまたは拒否されることがあります。

トランザクションの詳細については、「トランザクションをサポートする方法」を参照してください。

## <a name="transaction-provider"></a>トランザクションプロバイダー

トランザクション内で使用できるプロバイダーを作成できるようになりました。 コマンドレットと同様に、プロバイダーがトランザクションで使用されている場合、そのアクションは一時的であり、Windows PowerShell によって提供されるトランザクションコマンドレットによって受け入れまたは拒否されます。

プロバイダークラス内でのトランザクションのサポートを指定する方法の詳細については、「」を参照してください。

## <a name="job-cmdlets"></a>ジョブのコマンドレット

アクションをジョブとして実行できるコマンドレットを作成できるようになりました。 これらのジョブは、現在のセッションと対話することなくバックグラウンドで実行されます。 Windows PowerShell がジョブをサポートする方法の詳細については、「バックグラウンドジョブ」を参照してください。

## <a name="cmdlet-output-types"></a>コマンドレットの出力の種類

コマンドレットを記述するときに OutputType 属性を宣言することで、コマンドレットによって返される .NET Framework の種類を指定できるようになりました。 これにより、コマンドレットの OutputType プロパティを確認することで、コマンドレットによって返されるオブジェクトの種類を他のユーザーが判断できるようになります。

## <a name="event-support"></a>イベントのサポート

イベントを追加して使用するコマンドレットを作成できるようになりました。 PSEvent クラスを参照してください。

## <a name="proxy-commands"></a>プロキシコマンド

別のコマンドを実行するために使用できるプロキシコマンドを作成できるようになりました。 プロキシコマンドを使用すると、ユーザーが使用できる source コマンドレットの機能を制御できます。 たとえば、source コマンドによって指定されたパラメーターを削除するプロキシコマンドを作成できます。 ProxyCommand クラスを参照してください。

## <a name="multiple-choice-prompts"></a>複数選択のプロンプト

ユーザーが複数の選択肢を選択できるようにするためのプロンプトを提供できるアプリケーションを作成できるようになりました。 IHostUISupportsMultipleChoiceSelection インターフェイスを参照してください。

## <a name="interactive-sessions"></a>対話型セッション

リモートコンピューターで対話型セッションを開始および停止できるアプリケーションを作成できるようになりました。
IHostSupportsInteractiveSession インターフェイスを参照してください。

## <a name="custom-cmdlet-help-for-providers"></a>プロバイダーのカスタムコマンドレットヘルプ

プロバイダーコマンドレットのカスタマイズされたヘルプトピックを作成できるようになりました。 カスタムコマンドレットのヘルプトピックでは、プロバイダーパスでのコマンドレットの動作と、プロバイダーがコマンドレットに追加する動的パラメーターなどの特別な機能について説明します。
